I"l‘<ul id="markdown-toc">
  <li><a href="#å‚è€ƒ" id="markdown-toc-å‚è€ƒ">å‚è€ƒ</a></li>
  <li><a href="#iosys" id="markdown-toc-iosys"><strong>iosys()</strong></a></li>
  <li><a href="#setup" id="markdown-toc-setup"><strong>setup()</strong></a>    <ul>
      <li><a href="#å…·ä½“è®¾ç½®" id="markdown-toc-å…·ä½“è®¾ç½®">å…·ä½“è®¾ç½®</a></li>
    </ul>
  </li>
  <li><a href="#init_run" id="markdown-toc-init_run"><strong>init_run()</strong></a>    <ul>
      <li><a href="#call-pre_init" id="markdown-toc-call-pre_init"><code class="highlighter-rouge">CALL pre_init()</code></a></li>
      <li><a href="#data_structure-gamma_only-" id="markdown-toc-data_structure-gamma_only-"><strong><code class="highlighter-rouge">data_structure( gamma_only )</code></strong></a></li>
      <li><a href="#call-summary" id="markdown-toc-call-summary"><code class="highlighter-rouge">CALL summary()</code></a></li>
      <li><a href="#call-memory_report" id="markdown-toc-call-memory_report"><code class="highlighter-rouge">CALL memory_report()</code></a></li>
      <li><a href="#call-allocate_fft" id="markdown-toc-call-allocate_fft"><strong><code class="highlighter-rouge">CALL allocate_fft()</code></strong></a></li>
      <li><a href="#ggenggensäº§ç”Ÿå€’æ ¼å¼å’Œfft-indicesç´¢å¼•" id="markdown-toc-ggenggensäº§ç”Ÿå€’æ ¼å¼å’Œfft-indicesç´¢å¼•"><strong><code class="highlighter-rouge">ggen</code>&amp;<code class="highlighter-rouge">ggens</code>äº§ç”Ÿå€’æ ¼å¼å’Œfft indices(ç´¢å¼•)</strong></a></li>
      <li><a href="#xç•¥" id="markdown-toc-xç•¥">[x]ç•¥</a></li>
      <li><a href="#call-gshells--lmovecell-" id="markdown-toc-call-gshells--lmovecell-"><code class="highlighter-rouge">CALL gshells ( lmovecell )</code></a></li>
      <li><a href="#xç•¥-1" id="markdown-toc-xç•¥-1">[x]ç•¥</a></li>
      <li><a href="#call-allocate_nlpot" id="markdown-toc-call-allocate_nlpot"><strong><code class="highlighter-rouge">CALL allocate_nlpot()</code></strong></a></li>
      <li><a href="#x-ç•¥-allocatepawåŠ¿èƒ½" id="markdown-toc-x-ç•¥-allocatepawåŠ¿èƒ½">[x] ç•¥ ALLOCATEPAWåŠ¿èƒ½</a></li>
      <li><a href="#call-allocate_locpot" id="markdown-toc-call-allocate_locpot"><code class="highlighter-rouge">CALL allocate_locpot()</code></a></li>
      <li><a href="#call-allocate_wfc" id="markdown-toc-call-allocate_wfc"><strong><code class="highlighter-rouge">CALL allocate_wfc()</code></strong></a></li>
      <li><a href="#ç•¥" id="markdown-toc-ç•¥">ç•¥</a></li>
      <li><a href="#call-openfil" id="markdown-toc-call-openfil"><strong><code class="highlighter-rouge">CALL openfil()</code></strong></a></li>
      <li><a href="#call-hinit0" id="markdown-toc-call-hinit0"><code class="highlighter-rouge">CALL hinit0()</code></a></li>
      <li><a href="#call-potinit" id="markdown-toc-call-potinit"><code class="highlighter-rouge">CALL potinit()</code></a></li>
      <li><a href="#call-newd" id="markdown-toc-call-newd"><code class="highlighter-rouge">CALL newd()</code></a></li>
      <li><a href="#call-wfcinit" id="markdown-toc-call-wfcinit"><strong><code class="highlighter-rouge">CALL wfcinit()</code></strong></a></li>
      <li><a href="#ç•¥-1" id="markdown-toc-ç•¥-1">ç•¥</a></li>
    </ul>
  </li>
</ul>

<p>QEä»£ç é˜…è¯»ç³»åˆ—ï¼Œä¸ªäººå­¦ä¹ è®°å½•ï¼Œä»…ä¾›å‚è€ƒã€‚<br />
ä»£ç ä»“åº“<a href="https://gitee.com/cndaqiang/QE-6.4.1/tree/master">QE-6.4.1@cndaqiang</a><br /></p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p><a href="https://github.com/QEF/q-e.git">q-e code</a><br /></p>

<h2 id="iosys"><strong>iosys()</strong></h2>
<p>File:<code class="highlighter-rouge">PW/src/input.f90</code><br />
<strong>å¤åˆ¶å˜é‡è®¾ç½®å‚æ•°</strong>ï¼Œå¦‚<code class="highlighter-rouge">nat_=nat</code><br />
<strong>å¤åˆ¶å˜é‡ï¼Œè®¾ç½®è®¡ç®—å‚æ•°</strong>,å¦‚æ ¹æ®è®¡ç®—æ¨¡å¼`calculation=â€scf/md/â€¦â€œç­‰è®¾ç½®å‚æ•°,è®¾ç½®æ˜¯å¦è¿›è¡ŒæŸäº›è®¡ç®—å‚æ•°<br /></p>

<ul class="task-list">
  <li>
    <p>åˆå§‹åŒ–åŸå­ä¿¡æ¯ï¼Œ</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />ä¸€ç¾¤å‚æ•°è®¾ç½®â€¦</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />â€¦</p>
  </li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="highlighter-rouge">CALL read_cards_pw ( psfile, tau_format )</code>è¯»å…¥åŸå­ä½ç½®,é€Ÿåº¦,è´¨é‡,èµåŠ¿æ–‡ä»¶å<br />
File:æœ¬æ–‡ä»¶, i.e.<code class="highlighter-rouge">PW/src/input.f90</code><br />
è¯»å…¥å„ä¸ªå…ƒç´ çš„è´¨é‡ï¼ŒèµåŠ¿æ–‡ä»¶åï¼Œæ ‡ç­¾<br />
è¯»å…¥å„ä¸ªåŸå­çš„ä½ç½®ï¼Œç§ç±»ï¼Œå¤–åŠ›ï¼Œæ˜¯å¦å›ºå®šä½ç½®,åˆå§‹é€Ÿåº¦</li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><code class="highlighter-rouge">cell_base_init</code><em>è®¾ç½®æ™¶æ ¼å¸¸æ•°ï¼Œæ™¶æ ¼çŸ¢é‡, å€’æ ¼å¤±</em><br />
File:<code class="highlighter-rouge">Modules/cell_base.f90</code><br />
è¯¦ç»†çš„æ™¶æ ¼å‚æ•°å˜é‡å«ä¹‰è§å¸¸ç”¨å˜é‡è¡¨</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="highlighter-rouge">init_start_k</code>ç¡®å®škç‚¹æ¨¡å¼<br />
è¯»å…¥kç‚¹è®¾ç½®è¦æ±‚: æ‰‹åŠ¨/è‡ªåŠ¨, å¦‚è¿‡æ˜¯è‡ªåŠ¨æ¨¡å¼ï¼Œä¸ä¼šå»è®¾ç½®kç‚¹åæ ‡å’Œnks,åé¢ä¼šåœ¨setup()ä¸­è®¾ç½®ï¼Œæ­¤å¤„ä»…æ˜¯ç¡®å®šç®—å‚æ•°</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><strong><code class="highlighter-rouge">CALL readpp ( input_dft, .TRUE., ecutwfc_pp, ecutrho_pp )</code>è¯»å…¥èµåŠ¿PP</strong><br />
File:<code class="highlighter-rouge">Modules/read_pseudo.f90</code><br />
è¯»å…¥èµåŠ¿PP,è½¬<a href="/2020/04/05/qe-upf/">QEä»£ç é˜…è¯»: èµåŠ¿</a></p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="highlighter-rouge">  CALL set_cutoff ( ecutwfc, ecutrho, ecutwfc_pp, ecutrho_pp )</code>è®¾ç½®(è¯»å…¥)æˆªæ–­èƒ½
<br />è®¾ç½®æˆªæ–­èƒ½<code class="highlighter-rouge">ecutrho</code>å’Œ<code class="highlighter-rouge">ecutwfc</code>è®°å½•å€æ•°å…³ç³»<code class="highlighter-rouge">dual = ecutrho / ecutwfc</code></p>
  </li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />DFT+Då‚æ•°</li>
</ul>

<h2 id="setup"><strong>setup()</strong></h2>
<p>File:<code class="highlighter-rouge">PW/src/setup.f90</code></p>

<p>ç¨‹åºä¸­çš„æ³¨é‡Š: This routine is called at the beginning of the calculation and</p>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />1) determines various parameters of the calculation: 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">zv    </code>    charge of each atomic type 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">nelec </code>    total number of electrons (if not given in input) 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">nbnd  </code>    total number of bands (if not given in input) 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">nbndx </code>    max number of bands used in iterative diagonalization 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">tpiba </code>    2 pi / a (a = lattice parameter) 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">tpiba2</code>    square of tpiba 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">gcutm </code>    cut-off in g space for charge/potentials 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">gcutms</code>    cut-off in g space for smooth charge 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">ethr  </code>    convergence threshold for iterative diagonalization</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />2) finds actual crystal symmetry: 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">s     </code>    symmetry matrices in the direct lattice vectors basis 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">nsym  </code>    number of crystal symmetry operations 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">nrot  </code>    number of lattice symmetry operations 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">ft    </code>    fractionary translations 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">irt   </code>    for each atom gives the corresponding symmetric 
<br />Â  Â  Â  Â     <code class="highlighter-rouge">invsym</code>    if true the system has inversion symmetry</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />3) generates k-points corresponding to the actual crystal symmetry</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />4) calculates various quantities used in magnetic, spin-orbit, PAW 
<br />Â  Â  Â  Â     electric-field, LDA+U calculations, and for parallelism</li>
</ul>

<h3 id="å…·ä½“è®¾ç½®">å…·ä½“è®¾ç½®</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />åˆ¤æ–­èµåŠ¿ç±»å‹ã€€US, PAW, â€¦
<br /> å¯¹äºè¶…è½¯å’ŒPAW, æœ‰äº›è®¡ç®—è¿˜æ²¡æœ‰æ”¯æŒï¼Œè¦æ£€æŸ¥æŠ¥é”™,
<br /> TDPWçš„åŠ Sæ”¯æŒè¶…è½¯å’ŒPAW,æˆ‘å­˜ç–‘ï¼Œä½¿ç”¨NCæœ€é è°±</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />ç¦»å­ç”µè· <code class="highlighter-rouge">zv(1:ntyp) = upf(1:ntyp)%zp</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />ç”µå­ç”µè· <code class="highlighter-rouge">nelec = ionic_charge - tot_charge</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />ç£æ€§: æ˜¯å¦è®¡ç®—ç£æ€§<code class="highlighter-rouge">domag</code>,åˆå§‹ç£æ€§<code class="highlighter-rouge">starting_magnetization</code>,
<br /><code class="highlighter-rouge">nspin</code>,è‡ªæ—‹ä¸Šä¸‹ç”µå­æ•°<code class="highlighter-rouge">nelup</code>,<code class="highlighter-rouge">neldw</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><code class="highlighter-rouge">nbnd</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />scfè®¡ç®—ç²¾åº¦,<code class="highlighter-rouge">ethr</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />åŸå­æ³¢å‡½æ•°,set number of atomic wavefunctions
<br /> <code class="highlighter-rouge">natomwfc = n_atom_wfc( nat, ityp, noncolin )</code>
<br /> ç”¨äºåˆå§‹åŒ–æ³¢å‡½æ•°ï¼Œ<code class="highlighter-rouge">if natomwfc &gt; nbnd ; wfc_init random ; else wfc_init from atomic wfcs</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />æœ€å¤§å¯¹è§’åŒ–bandsæ•°,<code class="highlighter-rouge">nbndx = nbnd;IF ( isolve == 0 ) nbndx = david * nbnd</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />å€’ç©ºé—´å•ä½
<br />  å€’æ ¼çŸ¢å•ä½ <code class="highlighter-rouge">tpiba  = 2.D0 * pi / alat </code>
<br />  <code class="highlighter-rouge">tpiba2 = tpiba**2 </code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />GçŸ¢é‡æˆªæ–­,<code class="highlighter-rouge">gcutm,gcutw,gcutms</code>,å…·ä½“å«ä¹‰è§<a href="/2020/04/07/qe-mesh/">QEä»£ç é˜…è¯»: PW and grids</a>
<br />  <code class="highlighter-rouge">gcutm = dual * ecutwfc / tpiba2 = (ecutrho/ecutwfc) * ecutwfc / tpiba2 = ecutrho / tpiba2</code> cut-off in g space for charge/potentials
<br />  <code class="highlighter-rouge">gcutw = ecutwfc / tpiba2 </code> ,ecutwfcæ˜¯è¾“å…¥å‚æ•°<code class="highlighter-rouge">kinetic energy cutoff (Ry) for wavefunctions</code>,å› ä¸º<code class="highlighter-rouge">( (g+k)*tpiba )^2 &lt; ecutwfc , i.e. (g+k)^2 &lt; gcutw </code>
<br />  <code class="highlighter-rouge">gcutms = 4.D0 * ecutwfc / tpiba2</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />å¯»æ‰¾å¯¹ç§°æ€§</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />äº§ç”Ÿkç‚¹</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />LDA+U
<br /> <code class="highlighter-rouge">CALL init_lda_plus_u ( upf(1:ntyp)%psd, noncolin )</code></li>
</ul>

<h2 id="init_run"><strong>init_run()</strong></h2>
<p>File:<code class="highlighter-rouge">PW/src/init_run.f90</code>
<strong>åˆå§‹åŒ–ç‰©ç†é‡</strong></p>
<ul class="task-list">
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><code class="highlighter-rouge">CALL pre_init()</code>
<br /> File:æœ¬æ–‡ä»¶
<br /> è®¾ç½®betaå‡½æ•°æ•°é‡:<code class="highlighter-rouge">2*l+1</code>
<br /> å„å…ƒç´ çš„lmç»„åˆ/betaå‡½æ•°<code class="highlighter-rouge">do nt =1,nsp ; nh (nt) = sum_{l} 2*l + 1 = sum_{nb = 1, upf(nt)%nbeta}  2 * upf(nt)%lll(nb) + 1 </code>
<br /> <code class="highlighter-rouge">nspnhm = MAXVAL (nh (1:nsp))</code>æœ€å¤§lmç»„åˆ
<br /> <code class="highlighter-rouge">nbetam = MAXVAL (upf(:)%nbeta)</code>æœ€å¤§çš„l
<br /> æ‰€æœ‰åŸå­çš„betaå‡½æ•°æ•°é‡ä¹‹å’Œ<code class="highlighter-rouge">do na = 1, nat ; nkb = nkb + nh (nt=ityp(na))</code> 
<br /> USPPè¿˜ä¼šè®¾ç½®usppçš„betaå‡½æ•°åªå’Œnkbusï¼ŒåŒnkb</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><strong><code class="highlighter-rouge">CALL data_structure( gamma_only )</code></strong>
<br /> File:<code class="highlighter-rouge">PW/src/data_structure.f90</code>
<br /> è®¡ç®—fftç½‘æ ¼ç‚¹çš„æ³¢å‡½æ•°æˆªæ–­èƒ½<code class="highlighter-rouge">|k+G|^2</code>
<br /> åˆå§‹åŒ–æ³¢å‡½æ•°å’Œç”µè·å¯†åº¦çš„FFTæ•°æ®ç½‘æ ¼ç‚¹: ` dffts;dfftp<code class="highlighter-rouge">
&lt;br&gt; è®¡ç®—æ¯ä¸ªprocessorè´Ÿè´£çš„å¹³é¢æ³¢Gæ•°,å¹¶ALLOCATEå€’æ ¼å¤±</code>g<code class="highlighter-rouge">åŠç›¸å…³å˜é‡
&lt;br&gt; ä¸»è¦ä½¿ç”¨</code>FFTXlib/fft_types.f90 -&gt; fft_type_init`
<br /> è¯¦è§<a href="/2020/04/07/qe-mesh/">QEä»£ç é˜…è¯»: PW and grids</a></p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><code class="highlighter-rouge">CALL summary()</code>
<br /> File:<code class="highlighter-rouge">PW/src/summary.f90</code>
<br /> summaryä¿¡æ¯: ç”µå­,ç²¾åº¦,æ³›å‡½,æ™¶æ ¼,å€’æ ¼å¤±,èµåŠ¿ä¿¡æ¯,åŸå­ä½ç½®,U,kç‚¹,fftç½‘æ ¼</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><code class="highlighter-rouge">CALL memory_report()</code>
<br /> File:<code class="highlighter-rouge">PW/src/memory_report.f90</code>
<br /> è¾“å‡ºå†…å­˜å¯èƒ½çš„å ç”¨ç©ºå¯‚éš¾</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" /><code class="highlighter-rouge">CALL allocate_fft()</code>
<br />File: <code class="highlighter-rouge">PW/src/allocate_fft.f90</code>
<br />ç»™G- and R- ç©ºé—´ALLOCATE å˜é‡,å¦‚rho,vç­‰</p>
  </li>
  <li class="task-list-item">
    <p><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />åˆå§‹åŒ–ç”µè·ã€åŠ¿åœºã€æ³¢å‡½æ•°ç­‰</p>
  </li>
</ul>

<h3 id="call-pre_init"><code class="highlighter-rouge">CALL pre_init()</code></h3>
<p><br /><br /></p>

<h3 id="data_structure-gamma_only-"><strong><code class="highlighter-rouge">data_structure( gamma_only )</code></strong></h3>
<p>File:<code class="highlighter-rouge">PW/src/data_structure.f90</code><br />
åç»­æ›´æ–°ï¼Œè§<a href="/2020/04/07/qe-mesh/">QEä»£ç é˜…è¯»: PW and grids</a></p>

<p><br /><br /></p>

<h3 id="call-summary"><code class="highlighter-rouge">CALL summary()</code></h3>
<p>File:<code class="highlighter-rouge">PW/src/summary.f90</code><br /> 
æ²¡å•¥å¥½è¯´çš„ï¼Œå°±æ˜¯åŸºæœ¬ä¿¡æ¯<br />
èµåŠ¿è¿˜åŒ…å«å„ä¸ªèµåŠ¿çš„radial gridæ•°,betaå‡½æ•°ï¼Œç±»å‹,MD5,ä½œè€…ç­‰ä¿¡æ¯<br />
FFTä¼šä»‹ç»ä½¿ç”¨çš„ç½‘æ ¼ç‚¹æ•°
<br /><br /></p>

<h3 id="call-memory_report"><code class="highlighter-rouge">CALL memory_report()</code></h3>

<p><br /><br /></p>

<h3 id="call-allocate_fft"><strong><code class="highlighter-rouge">CALL allocate_fft()</code></strong></h3>
<p>File: <code class="highlighter-rouge">PW/src/allocate_fft.f90</code><br />
åˆå§‹åŒ–ä¸€äº›ç»™fftä½¿ç”¨çš„å˜é‡,æ¯”å¦‚å¯†åº¦(<code class="highlighter-rouge">rho</code>),åŠ¿èƒ½,æ³¢å‡½æ•°(å¦‚<code class="highlighter-rouge">psic</code>å°±æ˜¯ç»™fftä½¿ç”¨çš„æ³¢å‡½æ•°,æ³¨<code class="highlighter-rouge">evc</code>æ˜¯æ¼”åŒ–çš„æ³¢å‡½æ•°,ä¸åœ¨è¿™é‡Œallocate)<br /></p>

<p>æ›´è¯¦ç»†çš„å‚è€ƒ<a href="/2020/04/07/qe-mesh/">QEä»£ç é˜…è¯»: PW and grids</a>ä¸­<strong>allocate_fft()ä¸ºFFTç»§ç»­åˆ†é…å˜é‡</strong>éƒ¨åˆ†
<br /><br /></p>

<h3 id="ggenggensäº§ç”Ÿå€’æ ¼å¼å’Œfft-indicesç´¢å¼•"><strong><code class="highlighter-rouge">ggen</code>&amp;<code class="highlighter-rouge">ggens</code>äº§ç”Ÿå€’æ ¼å¼å’Œfft indices(ç´¢å¼•)</strong></h3>
<p>File:<code class="highlighter-rouge">Modules/recvec_subs.f90</code><br />
ç”Ÿæˆå„ä¸ªprocessorè®¡ç®—çš„Gç‚¹åæ ‡<code class="highlighter-rouge">g</code>,millæŒ‡æ•°ç­‰<br />
æ›´è¯¦ç»†çš„å‚è€ƒ<a href="/2020/04/07/qe-mesh/">QEä»£ç é˜…è¯»: PW and grids</a>ä¸­<strong><code class="highlighter-rouge">ggen</code>&amp;<code class="highlighter-rouge">ggens</code>äº§ç”Ÿå€’æ ¼å¼å’Œfftç´¢å¼•</strong>éƒ¨åˆ†</p>

<p><br /><br /></p>

<h3 id="xç•¥">[x]ç•¥</h3>
<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">do_comp_esm</span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">esm_init</span><span class="p">()</span><span class="w">
  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">do_cutoff_2D</span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">cutoff_fact</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><br /><br /></p>

<h3 id="call-gshells--lmovecell-"><code class="highlighter-rouge">CALL gshells ( lmovecell )</code></h3>
<p>File:<code class="highlighter-rouge">Modules/recvec.f90</code><br /></p>

<ul>
  <li>æ˜¯å¦æ˜¯å˜èƒvcè®¡ç®—ï¼Œlmovecell</li>
  <li>ç»Ÿè®¡æœ‰<code class="highlighter-rouge">ngl</code>ä¸ª<code class="highlighter-rouge">|G|^2</code>å–å€¼,æœ¬å¤„ç†å™¨å¤„ç†çš„ç¬¬<code class="highlighter-rouge">ig</code>ä¸ªGç‚¹ï¼Œæ˜¯ç¬¬å‡ ä¸ªshell,<code class="highlighter-rouge">igtongl (ig) =igl</code>,ç¬¬<code class="highlighter-rouge">igl</code>ä¸ª<code class="highlighter-rouge">|G|^2</code>æ˜¯<code class="highlighter-rouge">gl(igl)</code></li>
</ul>

<p><br /><br /></p>

<h3 id="xç•¥-1">[x]ç•¥</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  CALL sym_rho_init (gamma_only )
</code></pre></div></div>

<p><br /><br /></p>

<h3 id="call-allocate_nlpot"><strong><code class="highlighter-rouge">CALL allocate_nlpot()</code></strong></h3>
<p>File:<code class="highlighter-rouge">PW/src/allocate_nlpot.f90</code><br />
ALLOCATEéå±€åŸŸåŠ¿èƒ½</p>
<ul>
  <li>è®¡ç®—å¹³é¢æ³¢æ•°<strong><code class="highlighter-rouge">npwx</code>å¤§å°ï¼Œè¿™æ˜¯å°†æ¥å¯¹è§’åŒ–ã€æ³¢å‡½æ•°å•kç‚¹æ¯ä¸ªcpuä¸Šçš„æœ€å¤§çš„å¹³é¢æ³¢æ•°</strong><br />
ä¸æ‰€æœ‰å¤„ç†å™¨ä¸­çš„<code class="highlighter-rouge">dffts%nwl</code>çš„æœ€å¤§å€¼å¯¹åº”ï¼Œåœ¨Parallelization infoæ—¶è¾“å‡ºäº†,
<img src="/uploads/2020/04/npwx.png" alt="" /><br />
ä½¿ç”¨<code class="highlighter-rouge">ecutwfc</code>è®¡ç®—çš„Gç‚¹,<script type="math/tex">gkcut = \left \| \sqrt{G_{ecutwfc}} + k_{max}  \right \|^{2}</script><br /></li>
  <li>allocateå˜é‡ï¼Œå¦‚åŠ¨èƒ½<code class="highlighter-rouge">g2kin(npwx)</code></li>
  <li>è¿˜æœ‰allocateå¥½å¤šè¿™ç§ç»´åº¦çš„å˜é‡<code class="highlighter-rouge">indv( nhm, nsp)</code>,<code class="highlighter-rouge">vkb( npwx,  nkb)</code>,ç­‰éå±€åŸŸåŠ¿èƒ½éœ€è¦çš„å˜é‡</li>
</ul>

<p><br /><br /></p>

<h3 id="x-ç•¥-allocatepawåŠ¿èƒ½">[x] ç•¥ ALLOCATEPAWåŠ¿èƒ½</h3>
<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">okpaw</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
     </span><span class="k">CALL</span><span class="w"> </span><span class="n">allocate_paw_internals</span><span class="p">()</span><span class="w">
     </span><span class="k">CALL</span><span class="w"> </span><span class="n">paw_init_onecenter</span><span class="p">()</span><span class="w">
  </span><span class="k">ENDIF</span><span class="w">
</span></code></pre></div></div>

<p><br /><br /></p>

<h3 id="call-allocate_locpot"><code class="highlighter-rouge">CALL allocate_locpot()</code></h3>
<p>File:<code class="highlighter-rouge">PW/src/allocate_locpot.f90</code><br />
ALLOCATEå±€åŸŸåŠ¿èƒ½å˜é‡</p>
<ul>
  <li><code class="highlighter-rouge">allocate (vloc( ngl, ntyp))</code></li>
  <li><code class="highlighter-rouge">allocate (strf( ngm, ntyp))</code></li>
  <li><code class="highlighter-rouge">allocate( eigts1(-dfftp%nr1:dfftp%nr1,nat) )</code></li>
  <li><code class="highlighter-rouge">allocate( eigts2(-dfftp%nr2:dfftp%nr2,nat) )</code></li>
  <li><code class="highlighter-rouge">allocate( eigts3(-dfftp%nr3:dfftp%nr3,nat) )</code></li>
</ul>

<p><br /><br /></p>

<h3 id="call-allocate_wfc"><strong><code class="highlighter-rouge">CALL allocate_wfc()</code></strong></h3>
<p>File:<code class="highlighter-rouge">PW/src/allocate_wfc.f90</code><br />
ALLOCATEå¯¹è§’åŒ–ä½¿ç”¨çš„æ³¢å‡½æ•°<code class="highlighter-rouge">evc</code>ç­‰å‚æ•°</p>
<ul>
  <li><code class="highlighter-rouge">ALLOCATE( evc( npwx*npol, nbnd ) )</code></li>
  <li><code class="highlighter-rouge">ALLOCATE( swfcatom( npwx*npol, natomwfc) )</code></li>
  <li><code class="highlighter-rouge">ALLOCATE( wfcU(npwx*npol, nwfcU) )</code></li>
</ul>

<p><br /><br /></p>

<h3 id="ç•¥">ç•¥</h3>
<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="k">CALL</span><span class="w"> </span><span class="n">allocate_bp_efield</span><span class="p">()</span><span class="w">
  </span><span class="k">CALL</span><span class="w"> </span><span class="n">bp_global_map</span><span class="p">()</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="k">call</span><span class="w"> </span><span class="n">plugin_initbase</span><span class="p">()</span><span class="w">    </span><span class="c1">!==== ç©ºç™½</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w"> </span><span class="n">et</span><span class="p">(</span><span class="w"> </span><span class="n">nbnd</span><span class="p">,</span><span class="w"> </span><span class="n">nkstot</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wg</span><span class="p">(</span><span class="w"> </span><span class="n">nbnd</span><span class="p">,</span><span class="w"> </span><span class="n">nkstot</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">btype</span><span class="p">(</span><span class="w"> </span><span class="n">nbnd</span><span class="p">,</span><span class="w"> </span><span class="n">nkstot</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="n">et</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.D0</span><span class="w">
  </span><span class="n">wg</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.D0</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="n">btype</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">"CNQ:ts_vdw"</span><span class="p">,</span><span class="n">ts_vdw</span><span class="w">  </span><span class="c1">!==æ­¤å¤„ä¸ºF</span><span class="w">
  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ts_vdw</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
     </span><span class="k">CALL</span><span class="w"> </span><span class="n">tsvdw_initialize</span><span class="p">()</span><span class="w">
     </span><span class="k">CALL</span><span class="w"> </span><span class="n">set_h_ainv</span><span class="p">()</span><span class="w">
  </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="w">
  </span><span class="c1">!</span><span class="w">
</span></code></pre></div></div>

<p><br /><br /></p>

<h3 id="call-openfil"><strong><code class="highlighter-rouge">CALL openfil()</code></strong></h3>
<p>File:<code class="highlighter-rouge">PW/src/openfil.f90</code><br /></p>
<ul>
  <li><strong>è®¡ç®—ä¸€ä¸ªkç‚¹çš„æ‰€æœ‰æ³¢å‡½æ•°çš„å¤§å°<code class="highlighter-rouge">nwordwfc  = nbnd*npwx*npol</code>ç”¨äºåé¢çš„æ³¢å‡½æ•°bufferè¯»å†™</strong>
    <blockquote>
      <p>nwordwfc is the record length (IN COMPLEX WORDS)
<br /> for the direct-access file containing wavefunctions
<br /> nwordatwfc/nwordwfcU as above for atomic/U-manifold wavefunctions</p>
    </blockquote>
    <ul>
      <li><code class="highlighter-rouge">nwordwfc  = nbnd*npwx*npol</code></li>
      <li><code class="highlighter-rouge">nwordatwfc= npwx*natomwfc*npol</code></li>
      <li><code class="highlighter-rouge">nwordwfcU = npwx*nwfcU*npol</code></li>
    </ul>
  </li>
  <li>ä¸ºè‡ªæ´½è®¡ç®—ï¼šæ‰“å¼€ä¸€äº›æ–‡ä»¶/bufferï¼ŒLDAçš„buffer,å¦‚ç”µåœºæ–‡ä»¶çš„buffer
    <div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CALL</span><span class="w"> </span><span class="n">open_buffer</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iunhub</span><span class="p">,</span><span class="w"> </span><span class="s1">'hub'</span><span class="p">,</span><span class="w">    </span><span class="n">nwordwfcU</span><span class="p">,</span><span class="w"> </span><span class="n">io_level</span><span class="p">,</span><span class="w"> </span><span class="n">exst</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="k">CALL</span><span class="w"> </span><span class="n">open_buffer</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iunsat</span><span class="p">,</span><span class="w"> </span><span class="s1">'satwfc'</span><span class="p">,</span><span class="w"> </span><span class="n">nwordatwfc</span><span class="p">,</span><span class="w"> </span><span class="n">io_level</span><span class="p">,</span><span class="w"> </span><span class="n">exst</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="k">CALL</span><span class="w"> </span><span class="n">open_buffer</span><span class="p">(</span><span class="w"> </span><span class="n">iunefield</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">'ewfc'</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nwordwfc</span><span class="p">,</span><span class="w"> </span><span class="n">io_level</span><span class="p">,</span><span class="w"> </span><span class="n">exst</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="k">CALL</span><span class="w"> </span><span class="n">open_buffer</span><span class="p">(</span><span class="w"> </span><span class="n">iunefieldm</span><span class="p">,</span><span class="w"> </span><span class="s1">'ewfcm'</span><span class="p">,</span><span class="w"> </span><span class="n">nwordwfc</span><span class="p">,</span><span class="w"> </span><span class="n">io_level</span><span class="p">,</span><span class="w"> </span><span class="n">exst</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="k">CALL</span><span class="w"> </span><span class="n">open_buffer</span><span class="p">(</span><span class="w"> </span><span class="n">iunefieldp</span><span class="p">,</span><span class="w"> </span><span class="s1">'ewfcp'</span><span class="p">,</span><span class="w"> </span><span class="n">nwordwfc</span><span class="p">,</span><span class="w"> </span><span class="n">io_level</span><span class="p">,</span><span class="w"> </span><span class="n">exst</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="call-hinit0"><code class="highlighter-rouge">CALL hinit0()</code></h3>
<p>File:<code class="highlighter-rouge">PW/src/hinit0.f90</code></p>
<blockquote>
  <p>â€¦ hamiltonian initialization: 
<br />  â€¦ atomic position independent initialization for nonlocal PP,
<br /> V_nl(r)
<br />  â€¦ structure factors, local potential, core charge</p>
</blockquote>

<ul>
  <li><code class="highlighter-rouge">struc_fact</code>
File:<code class="highlighter-rouge">PW/src/struct_fact.f90</code><br />
è®¡ç®—ç»“æ„å› å­<code class="highlighter-rouge">strf</code>,åç»­çš„ewaldæ±‚å’Œç”¨çš„åˆ°<br />
    <ul>
      <li>èµµæ˜æ–‡è€å¸ˆåœ¨å›ºä½“ç‰©ç†ä¸­è®²çš„ç»“æ„å› å­å®šä¹‰ä¸º<script type="math/tex">s_G=\sum_{j=1}^{s}f_j \exp(-i \overrightarrow{r_j} \cdot \overrightarrow{G} )</script>, where <script type="math/tex">f_j</script> æ˜¯åŸå­ç»“æ„å› å­ï¼Œæ±‚å’Œå¯¹åŸèƒä¸­æ‰€æœ‰åŸå­æ±‚å’Œ<br /></li>
      <li>QEä¸­ï¼Œå…ƒç´ <code class="highlighter-rouge">itype</code>,åœ¨<code class="highlighter-rouge">ing</code>Gç‚¹ä¸Šçš„ï¼Œ<code class="highlighter-rouge">strf (ing, int) </code>ä¸º<script type="math/tex">s_G=\sum_{j=1}^{s} \exp(-i \overrightarrow{r_j} \cdot \overrightarrow{G} )</script><br />
 æ±‚å’Œä»…å¯¹åŒä¸€å…ƒç´ ï¼Œè¿˜æœªä¹˜ä¸Š<script type="math/tex">f_j</script>,æœªå¯¹æ‰€æœ‰å…ƒç´ æ±‚å’Œ<br /></li>
      <li>æ ¹æ®<strong>æ½˜èª. åˆ†å­æ¨¡æ‹Ÿä¸­é™ç”µåŠ›è®¡ç®—æ–¹æ³•çš„ç ”ç©¶[D].å‰æ—å¤§å­¦,2017.</strong>æåˆ°æ–‡çŒ®ä¸­ä¸€èˆ¬å®šä¹‰çš„ç»“æ„å› å­<script type="math/tex">s_G= \sum_{j=1}^{s} z_j \cdot \exp(i \overrightarrow{r_j} \cdot \overrightarrow{G} )</script>,where <script type="math/tex">z_j</script>ä¸ºæ ¸ç”µè·æ•°ï¼Œè¿™æˆ–è®¸å°±æ˜¯QEåœ¨è®¡ç®—ewaldèƒ½æ—¶<code class="highlighter-rouge">rhon = rhon + zv (nt) * CONJG(strf (ng, nt) )</code>çš„åŸå› <br /><br /><br /></li>
      <li>æ­¤å¤„è¿˜è®¡ç®—äº†<code class="highlighter-rouge">eigts1(n1,j)=exp(-i*bg1*r_j*r'_n1)</code>, i.e. <script type="math/tex">exp(-i\cdot b_1 \cdot r_j \cdot r')</script>, where,bå€’æ ¼å¼ï¼Œ<code class="highlighter-rouge">r'</code>FFTç½‘æ ¼ç‚¹ï¼Œ<code class="highlighter-rouge">r_j</code>åŸå­åæ ‡ï¼ŒåŒç†<code class="highlighter-rouge">eigts2,eigts3</code>
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CALL struc_fact( nat, tau, nsp, ityp, ngm, g, bg, &amp;
             dfftp%nr1, dfftp%nr2, dfftp%nr3, strf, eigts1, eigts2, eigts3 )
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">CALL setlocal()</code>
è®¾ç½®localåŠ¿èƒ½<code class="highlighter-rouge">vltot</code>
    <blockquote>
      <p>calculate the total local potential</p>
    </blockquote>
  </li>
  <li><code class="highlighter-rouge">CALL set_rhoc()</code>
è®¾ç½®èŠ¯ç”µè·å¯†åº¦<code class="highlighter-rouge">rho_core,rhog_core</code>
    <blockquote>
      <p>calculate the core charge (if any) for the nonlinear core correction</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="call-potinit"><code class="highlighter-rouge">CALL potinit()</code></h3>
<p>File:<code class="highlighter-rouge">PW/src/potinit.f90</code></p>

<p>åˆå§‹åŒ–ç”µè·å¯†åº¦rho,åŠ¿èƒ½<code class="highlighter-rouge">vrs,v</code>ï¼Œå…·ä½“æ–¹æ³•ç­‰å¾…ç»§ç»­å…¥ã€‚<br /></p>

<ul>
  <li>åˆå§‹åŒ–å¯†åº¦<code class="highlighter-rouge">rho</code>
    <ul>
      <li>åˆå§‹åŒ–å€’ç©ºé—´çš„ç”µè·å¯†åº¦<code class="highlighter-rouge">rho%of_g</code>
        <blockquote>
          <p>â€¦ This routine initializes the self consistent potential in the array
<br />  â€¦ <code class="highlighter-rouge">vr</code>. There are three possible cases:
<br /> 
<br />  â€¦ a) the code is restarting from a broken run:
<br />  â€¦    read rho from data stored during the previous run
<br />  â€¦ b) the code is performing a non-scf calculation following a scf     one:
<br />  â€¦    read rho from the file produced by the scf calculation
<br />  â€¦ c) the code starts a new calculation:
<br />  â€¦    calculate rho as a sum of atomic charges
<br />  â€¦ In all cases the scf potential is recalculated and saved in vr</p>
        </blockquote>
      </li>
      <li>éªŒè¯å¯†åº¦æ˜¯å¦åˆç†<code class="highlighter-rouge">charge = omega*REAL( rho%of_g(1,1) )</code>ï¼Œè¯æ˜è§<a href="/2020/04/07/qe-mesh/#ç”µè·å¯†åº¦rhoçš„fftçš„ç©ºé—´ç½‘æ ¼">QEä»£ç é˜…è¯»: PW and grids</a></li>
      <li>æŠŠgç©ºé—´çš„å¯†åº¦è½¬åˆ°rç©ºé—´<code class="highlighter-rouge">rho%of_r</code>ä¸­
  <br /><code class="highlighter-rouge">CALL rho_g2r (dfftp, rho%of_g, rho%of_r)</code></li>
      <li>å…¶ä»–å¯†åº¦<code class="highlighter-rouge">rho%kin_g, rho%kin_r</code></li>
    </ul>
  </li>
  <li>è®¡ç®—åŠ¿èƒ½<code class="highlighter-rouge">v</code></li>
  <li>è®¡ç®—åŠ¿èƒ½<code class="highlighter-rouge">vrs</code></li>
</ul>

<p><br /><br /></p>

<h3 id="call-newd"><code class="highlighter-rouge">CALL newd()</code></h3>
<p>File:<code class="highlighter-rouge">PW/src/newd.f90</code><br />
ç•¥,ç¼ºå°‘pseudoå’Œpwçš„è¿›ä¸€æ­¥çŸ¥è¯†</p>

<p><br /><br /></p>

<h3 id="call-wfcinit"><strong><code class="highlighter-rouge">CALL wfcinit()</code></strong></h3>
<p>File:<code class="highlighter-rouge">PW/src/wfcinit.f90</code><br />
ä»atomicæˆ–randomåˆå§‹åŒ–æ³¢å‡½æ•°ï¼Œæ‰“å¼€wfcçš„bufferå¹¶<code class="highlighter-rouge">save_buffer</code></p>

<p><br /><br /></p>

<h3 id="ç•¥-1">ç•¥</h3>
<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="n">use_wannier</span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">wannier_init</span><span class="p">()</span><span class="w">
  </span><span class="c1">!</span><span class="w">
</span><span class="cp">#if defined(__MPI)</span><span class="w">
  </span><span class="c1">! Cleanup PAW arrays that are only used for init</span><span class="w">
  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">okpaw</span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">paw_post_init</span><span class="p">()</span><span class="w"> </span><span class="c1">! only parallel!</span><span class="w">
</span><span class="cp">#endif</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">"CNQ:lmd"</span><span class="p">,</span><span class="n">lmd</span><span class="c1">!=== æ­¤å¤„ä¸ºT</span><span class="w">
  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">allocate_dyn_vars</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><br /><br /></p>
:ET