I"U<ul id="markdown-toc">
  <li><a href="#æ¨èçœ‹æ­¤æ–‡ä»0æ­å»ºcentos7-è®¡ç®—é›†ç¾¤" id="markdown-toc-æ¨èçœ‹æ­¤æ–‡ä»0æ­å»ºcentos7-è®¡ç®—é›†ç¾¤">æ¨èçœ‹æ­¤æ–‡ä»0æ­å»ºCentos7 è®¡ç®—é›†ç¾¤</a></li>
  <li><a href="#å‚è€ƒ" id="markdown-toc-å‚è€ƒ">å‚è€ƒ</a></li>
  <li><a href="#é›†ç¾¤ç³»ç»Ÿ" id="markdown-toc-é›†ç¾¤ç³»ç»Ÿ">é›†ç¾¤ç³»ç»Ÿ</a>    <ul>
      <li><a href="#èŠ‚ç‚¹" id="markdown-toc-èŠ‚ç‚¹">èŠ‚ç‚¹</a></li>
    </ul>
  </li>
  <li><a href="#å•æœºå®‰è£…" id="markdown-toc-å•æœºå®‰è£…">å•æœºå®‰è£…</a>    <ul>
      <li><a href="#ä¸»èŠ‚ç‚¹masteré…ç½®" id="markdown-toc-ä¸»èŠ‚ç‚¹masteré…ç½®">ä¸»èŠ‚ç‚¹(master)é…ç½®</a></li>
      <li><a href="#ç¯å¢ƒ" id="markdown-toc-ç¯å¢ƒ">ç¯å¢ƒ</a></li>
      <li><a href="#ä¸‹è½½" id="markdown-toc-ä¸‹è½½">ä¸‹è½½</a></li>
      <li><a href="#å®‰è£…ä¾èµ–" id="markdown-toc-å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–</a></li>
      <li><a href="#ç¼–è¯‘å®‰è£…" id="markdown-toc-ç¼–è¯‘å®‰è£…">ç¼–è¯‘å®‰è£…</a>        <ul>
          <li><a href="#æ·»åŠ ç³»ç»ŸæœåŠ¡" id="markdown-toc-æ·»åŠ ç³»ç»ŸæœåŠ¡">æ·»åŠ ç³»ç»ŸæœåŠ¡</a></li>
          <li><a href="#æ·»åŠ å¼€æœºå¯åŠ¨" id="markdown-toc-æ·»åŠ å¼€æœºå¯åŠ¨">æ·»åŠ å¼€æœºå¯åŠ¨</a></li>
        </ul>
      </li>
      <li><a href="#æ‰“åŒ…ç”Ÿæˆä¸ªèŠ‚ç‚¹å®‰è£…åŒ…" id="markdown-toc-æ‰“åŒ…ç”Ÿæˆä¸ªèŠ‚ç‚¹å®‰è£…åŒ…">æ‰“åŒ…ï¼Œç”Ÿæˆä¸ªèŠ‚ç‚¹å®‰è£…åŒ…</a></li>
      <li><a href="#åˆå§‹åŒ–" id="markdown-toc-åˆå§‹åŒ–">åˆå§‹åŒ–</a></li>
      <li><a href="#å¯åŠ¨ç¨‹åº" id="markdown-toc-å¯åŠ¨ç¨‹åº">å¯åŠ¨ç¨‹åº</a></li>
      <li><a href="#é…ç½®èŠ‚ç‚¹" id="markdown-toc-é…ç½®èŠ‚ç‚¹">é…ç½®èŠ‚ç‚¹</a>        <ul>
          <li><a href="#ç®¡ç†èŠ‚ç‚¹è°ƒåº¦èŠ‚ç‚¹master" id="markdown-toc-ç®¡ç†èŠ‚ç‚¹è°ƒåº¦èŠ‚ç‚¹master">ç®¡ç†èŠ‚ç‚¹(è°ƒåº¦èŠ‚ç‚¹,master)</a></li>
          <li><a href="#è®¡ç®—èŠ‚ç‚¹" id="markdown-toc-è®¡ç®—èŠ‚ç‚¹">è®¡ç®—èŠ‚ç‚¹</a></li>
          <li><a href="#è®¡ç®—èŠ‚ç‚¹é…ç½®" id="markdown-toc-è®¡ç®—èŠ‚ç‚¹é…ç½®">è®¡ç®—èŠ‚ç‚¹é…ç½®</a></li>
          <li><a href="#åˆ›å»ºé˜Ÿåˆ—" id="markdown-toc-åˆ›å»ºé˜Ÿåˆ—">åˆ›å»ºé˜Ÿåˆ—</a></li>
          <li><a href="#æ³¨" id="markdown-toc-æ³¨">æ³¨</a></li>
        </ul>
      </li>
      <li><a href="#æµ‹è¯•æäº¤ä»»åŠ¡qsub" id="markdown-toc-æµ‹è¯•æäº¤ä»»åŠ¡qsub">æµ‹è¯•æäº¤ä»»åŠ¡<code class="highlighter-rouge">qsub</code></a></li>
    </ul>
  </li>
  <li><a href="#ä½¿ç”¨" id="markdown-toc-ä½¿ç”¨">ä½¿ç”¨</a>    <ul>
      <li><a href="#å‘½ä»¤" id="markdown-toc-å‘½ä»¤">å‘½ä»¤</a></li>
      <li><a href="#pbsè„šæœ¬æ–‡ä»¶" id="markdown-toc-pbsè„šæœ¬æ–‡ä»¶">PBSè„šæœ¬æ–‡ä»¶</a>        <ul>
          <li><a href="#è¯´æ˜" id="markdown-toc-è¯´æ˜">è¯´æ˜</a></li>
          <li><a href="#pbsè¿è¡Œå‚æ•°" id="markdown-toc-pbsè¿è¡Œå‚æ•°">PBSè¿è¡Œå‚æ•°</a></li>
          <li><a href="#è¿è¡Œvaspç¤ºä¾‹" id="markdown-toc-è¿è¡Œvaspç¤ºä¾‹">è¿è¡ŒVASPç¤ºä¾‹</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="æ¨èçœ‹æ­¤æ–‡ä»0æ­å»ºcentos7-è®¡ç®—é›†ç¾¤">æ¨èçœ‹æ­¤æ–‡<a href="/2019/09/19/Centos7-CC19/">ä»0æ­å»ºCentos7 è®¡ç®—é›†ç¾¤</a></h1>
<p>2019-09-19:ä»¥åé‡åˆ°çš„é—®é¢˜æˆ‘ä¹Ÿä»…ä¼šæ›´æ–°åˆ°æ­¤æ–‡<a href="/2019/09/19/Centos7-CC19/">ä»0æ­å»ºCentos7 è®¡ç®—é›†ç¾¤</a><br />
æœ¬æ–‡ä¸å†æ›´æ–°<br />
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br />
æœ¬æ–‡ä¸»è¦åœ¨ubuntuç¼–è¯‘å¤±è´¥çš„åŸºç¡€ä¸Šå¤åˆ¶è¿‡æ¥ï¼Œåœ¨centosä¸Šè¿›è¡Œå®‰è£…å°è¯•ã€‚<br />
æœ¬æ–‡æœ€åˆçš„ç›®çš„æ˜¯æˆ‘å¸Œæœ›æ­å»ºä¸€ä¸ªç¯å¢ƒç†Ÿæ‚‰torqueçš„å‘½ä»¤çš„ï¼Œæ‰€ä»¥æ­å»ºçš„å¹¶ä¸é€‚åˆä»äº‹é›†ç¾¤è®¡ç®—
<br />æ­å»ºè®¡ç®—çš„é›†ç¾¤å¯ä»¥å‚è€ƒ<a href="/doc/2018/01/xiada-ssh-mpich2-torque.pdf">é›†ç¾¤æ¶è®¾
</a>å’Œ<a href="http://blog.csdn.net/dream_angel_z/article/details/44225669">CentOSä¸‹torqueé›†ç¾¤é…ç½®ï¼ˆä¸€ï¼‰-torqueå®‰è£…ä¸é…ç½®</a></p>

<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p><a href="http://blog.sciencenet.cn/blog-478347-395684.html">[è½¬è½½]PBSï¼ï¼</a>
<br /><a href="https://stackoverflow.com/questions/25979525/cannot-find-lssl-cannot-find-lcrypto-when-installing-mysql-python-using-mar">â€œcannot find -lssl; cannot find -lcryptoâ€ when installing mysql-python using mariaDB library</a>
<br /><a href="https://stackoverflow.com/questions/12578499/how-to-install-boost-on-ubuntu/12578564#12578564?newreg=1035048611464711a0444542ec818276">How to Install boost on Ubuntu?
</a>
<br /><a href="http://blog.51cto.com/rabbitjian/1862678">PBS Torque 5.1.3å®‰è£…é…ç½®</a>
<br /><a href="http://blog.csdn.net/dream_angel_z/article/details/44225669">CentOSä¸‹torqueé›†ç¾¤é…ç½®ï¼ˆä¸€ï¼‰-torqueå®‰è£…ä¸é…ç½®</a>
<br /><a href="https://zhidao.baidu.com/question/328528962.html">shellç¼–ç¨‹ã€‚ubuntuä¸‹çš„shellå‡ºé”™ï¼Œæç¤ºç¬¬4è¡Œfunction: not foundï¼Œè¿˜æœ‰ç¬¬ä¸ƒè¡Œçš„ } æœ‰é”™ã€‚é«˜æ‰‹æ•™ä¸€ä¸‹</a>
<br /><a href="https://www.panda-os.com/blog/2013/06/red5-init-script-for-ubuntu/">RED5 INIT SCRIPT FOR UBUNTU</a>
<br /><a href="http://www.cnblogs.com/huangpeng/archive/2009/03/11/1408926.html">hostsæ–‡ä»¶è¯¦è§£</a></p>

<h1 id="é›†ç¾¤ç³»ç»Ÿ">é›†ç¾¤ç³»ç»Ÿ</h1>
<p>é›†ç¾¤ç³»ç»Ÿå°±å¥½åƒä¸€å°æœåŠ¡å™¨æˆ–è€…PCï¼Œé›†ç¾¤èµ„æºç”±å®ç°å¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
  <li>èµ„æºç®¡ç†å™¨
<br />ä¸ºäº†ç¡®ä¿åˆ†é…ç»™ä½œä¸šåˆé€‚çš„èµ„æºï¼Œé›†ç¾¤èµ„æºç®¡ç†éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“ã€‚è¿™ä¸ªæ•°æ®åº“è®°å½•äº†é›†ç¾¤ç³»ç»Ÿä¸­å„ç§èµ„æºçš„å±æ€§å’ŒçŠ¶æ€ã€æ‰€æœ‰ç”¨æˆ·æäº¤çš„è¯·æ±‚å’Œæ­£åœ¨è¿è¡Œçš„ä½œä¸šã€‚</li>
  <li>ä½œä¸šè°ƒåº¦ç­–ç•¥ç®¡ç†å™¨
<br />ç­–ç•¥ç®¡ç†å™¨æ ¹æ®èµ„æºç®¡ç†å™¨å¾—åˆ°å„ä¸ªç»“ç‚¹ä¸Šçš„èµ„æºçŠ¶å†µå’Œç³»ç»Ÿçš„ä½œä¸šä¿¡æ¯ç”Ÿæˆä¸€ä¸ªä¼˜å…ˆçº§åˆ—è¡¨ã€‚è¿™ä¸ªåˆ—è¡¨å‘Šè¯‰èµ„æºç®¡ç†å™¨ä½•æ—¶åœ¨å“ªäº›ç»“ç‚¹ä¸Šè¿è¡Œå“ªä¸ªä½œä¸š</li>
</ul>

<blockquote>
  <p>PBSä½œä¸šåˆ†é…çš„è°ƒåº¦å™¨ ï¼ˆschedulerï¼‰ï¼Œå…¶ä¸»è¦ä»»åŠ¡æ˜¯åˆ†é…æ‰¹ä½œä¸šè®¡ç®—ä»»åŠ¡åˆ°ç°æœ‰çš„è®¡ç®—èµ„æºä¸Šã€‚ PBSçš„ç›®å‰åŒ…æ‹¬openPBSï¼ŒPBS Proå’ŒTorqueä¸‰ä¸ªä¸»è¦åˆ†æ”¯ã€‚ å…¶ä¸­OpenPBSæ˜¯æœ€æ—©çš„PBSç³»ç»Ÿï¼Œç›®å‰å·²ç»æ²¡æœ‰å¤ªå¤šåç»­å¼€å‘ï¼ŒPBS proæ˜¯PBSçš„å•†ä¸šç‰ˆæœ¬ï¼ŒåŠŸèƒ½æœ€ä¸ºä¸°å¯Œã€‚Torqueæ˜¯Clusteringå…¬å¸æ¥è¿‡äº†OpenPBSï¼Œå¹¶ç»™ä¸åç»­æ”¯æŒçš„ä¸€ä¸ªå¼€æºç‰ˆæœ¬ã€‚<br />
Mauiä½œä¸šè°ƒåº¦å™¨,æƒ³è±¡ä¸ºPBSä¸­çš„ä¸€ä¸ªæ’å…¥éƒ¨ä»¶ã€‚å®ƒé‡‡ç”¨ç§¯æçš„è°ƒåº¦ç­–ç•¥ä¼˜åŒ–èµ„æºçš„åˆ©ç”¨å’Œå‡å°‘ä½œä¸šçš„å“åº”æ—¶é—´</p>
</blockquote>

<h2 id="èŠ‚ç‚¹">èŠ‚ç‚¹</h2>
<p>å¯¹äºtorque PBSæœ‰ä»¥ä¸‹èŠ‚ç‚¹</p>
<ul>
  <li>ç®¡ç†èŠ‚ç‚¹(master)
<br />é›†ç¾¤ç³»ç»Ÿçš„ç®¡ç†èŠ‚ç‚¹
<br />ç¼–è¯‘å®‰è£…ç®¡ç†Torque PBS
<br />å®‰è£…pbs_server</li>
  <li>è®¡ç®—èŠ‚ç‚¹
<br />å®‰è£…pbs_client
<br />å®‰è£…pbs_mom</li>
  <li>äº¤ä½œä¸šèŠ‚ç‚¹
<br />å®‰è£…pbs_client</li>
</ul>

<h1 id="å•æœºå®‰è£…">å•æœºå®‰è£…</h1>
<p>æ­¤æ¬¡è¿›è¡Œå•æœºå®‰è£…pbsï¼Œå³ç®¡ç†èŠ‚ç‚¹ï¼Œè®¡ç®—èŠ‚ç‚¹ï¼Œä½œä¸šèŠ‚ç‚¹éƒ½åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Š,ä¸å®‰è£…Maui</p>

<h2 id="ä¸»èŠ‚ç‚¹masteré…ç½®">ä¸»èŠ‚ç‚¹(master)é…ç½®</h2>
<p>å¦‚æ— ç‰¹æ®Šè¯´æ˜ï¼Œä»¥rootèº«ä»½è¿è¡Œ</p>
<h2 id="ç¯å¢ƒ">ç¯å¢ƒ</h2>
<p>centos 7</p>
<h2 id="ä¸‹è½½">ä¸‹è½½</h2>
<p>å®‰è£…åŒ…ä¸‹è½½åœ°å€<a href="http://www.adaptivecomputing.com/products/open-source/torque/">Torque Resource Manager</a></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget http://wpfilebase.s3.amazonaws.com/torque/torque-6.1.1.1.tar.gz
tar xzvf torque-6.1.1.1.tar.gz
cd torque-6.1.1.1
</code></pre></div></div>
<p>ä¸»æœºåå¯æ”¹ä¸ºmaster,æˆ‘ä¸æ”¹äº†,æŸ¥çœ‹ä¸»æœºåä¸ºVM_10_194_centos</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@VM_10_194_centos torque-6.1.1.1]# echo $HOSTNAME
VM_10_194_centos
</code></pre></div></div>
<p>ä¿®æ”¹<code class="highlighter-rouge">/etc/hosts</code>ä½¿é‡Œæœ‰<code class="highlighter-rouge">127.0.0.1 ä¸»æœºåæˆ–åŸŸå [åˆ«å] [åˆ«å]</code>
<br /> ä¸»æœºåå¿…é¡»æ”¾åœ¨åˆ«åå‰é¢ï¼Œå³<code class="highlighter-rouge">VM_10_194_centos</code>è¦åœ¨<code class="highlighter-rouge">localhost</code>å‰é¢ï¼Œå¦‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1  VM_10_194_centos localhost  localhost.localdomain
::1        VM_10_194_centos localhost localhost.localdomain localhost6 localhost6.localdomain6 
</code></pre></div></div>
<p>å¤šèŠ‚ç‚¹æ—¶è¦è®¾ç½®å„ä¸ªèŠ‚ç‚¹çš„ä¸»æœºåå’Œip</p>
<h2 id="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install libxml2-devel openssl-devel gcc gcc-c++ boost-devel libtool -y
</code></pre></div></div>
<h2 id="ç¼–è¯‘å®‰è£…">ç¼–è¯‘å®‰è£…</h2>
<p>ç¼–è¯‘å®‰è£…</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure --prefix=/usr/local/torque --with-default-server=$HOSTNAME
make
make install
</code></pre></div></div>
<p>å…¶ä¸­</p>
<ul>
  <li><code class="highlighter-rouge">$HOSTNAME</code>æ˜¯ä¸»æœºå</li>
  <li><code class="highlighter-rouge">--prefix=å®‰è£…ç›®å½•</code>å‚æ•°å¯ä»¥ä¸å¸¦ï¼Œåˆ™é»˜è®¤å®‰è£…åˆ°<code class="highlighter-rouge">/usr/local/sbin</code>,<code class="highlighter-rouge">/usr/local/bin</code>ç›®å½•
<br />æ­¤å¤„å®‰è£…åˆ°<code class="highlighter-rouge">/usr/local/torque</code>å®‰è£…åéœ€è¦æ·»åŠ PATH
<br />æ·»åŠ PATH:
<br />åœ¨<code class="highlighter-rouge">/etc/profile</code>é‡Œæ·»åŠ <code class="highlighter-rouge">export PATH=/usr/local/torque/bin:/usr/local/torque/sbin:$PATH</code>
<br /><code class="highlighter-rouge">source /etc/profile</code>æˆ–è€…é€€å‡ºé‡æ–°ç™»é™†
<br />å¯é€šè¿‡<code class="highlighter-rouge">which pbs_server</code>æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ</li>
  <li>å¸è½½å‘½ä»¤<code class="highlighter-rouge"> make uninstall</code></li>
</ul>

<p><code class="highlighter-rouge">ls /usr/local/torque/sbin</code>å¯çœ‹åˆ°ä¸»è¦å®‰è£…äº†è¿™å‡ ä¸ªç¨‹åº</p>
<ul>
  <li>pbs_mom 
<br />PBS MOMå®ˆæŠ¤è¿›ç¨‹ï¼Œ è´Ÿè´£ç›‘æ§æœ¬æœºå¹¶æ‰§è¡Œä½œä¸šï¼Œä½äºæ‰€æœ‰è®¡ç®—èŠ‚ç‚¹ä¸Š</li>
  <li>pbs_sched
<br />PBSè°ƒåº¦å®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£è°ƒåº¦ä½œä¸šï¼Œä½äºæœåŠ¡èŠ‚ç‚¹ä¸Š</li>
  <li>pbs_server
<br />PBSæœåŠ¡å®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£æ¥æ”¶ä½œä¸šæäº¤ï¼Œä½äºæœåŠ¡èŠ‚ç‚¹ä¸Š</li>
</ul>

<h3 id="æ·»åŠ ç³»ç»ŸæœåŠ¡">æ·»åŠ ç³»ç»ŸæœåŠ¡</h3>
<p>å°†ä¸Šè¿°å‘½ä»¤è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp contrib/init.d/{pbs_{server,sched,mom},trqauthd} /etc/init.d/
</code></pre></div></div>
<p>ä¹‹åå¯ä»¥ä½¿ç”¨ç³»ç»ŸæœåŠ¡å‘½ä»¤å¿«é€Ÿå¯åŠ¨å…³é—­æŸ¥çœ‹çŠ¶æ€<br />
è€ç‰ˆcentoså‘½ä»¤,centos7å…¼å®¹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service pbs_server stop|start|restart|status
</code></pre></div></div>
<p>centos7è¿˜å¯ä»¥ä½¿ç”¨<code class="highlighter-rouge">systemctl</code>,</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl stop|start|restart|status pbs_server
</code></pre></div></div>
<h3 id="æ·»åŠ å¼€æœºå¯åŠ¨">æ·»åŠ å¼€æœºå¯åŠ¨</h3>
<p>æ·»åŠ ä¸ºç³»ç»ŸæœåŠ¡åå¯ä»¥æ·»åŠ å¼€æœºå¯åŠ¨<br />
è€ç‰ˆcentoså‘½ä»¤,centos7å…¼å®¹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chkconfig pbs_server on
chkconfig pbs_sched on
chkconfig pbs_mom on
</code></pre></div></div>
<p>centos7è¿˜å¯ä»¥ä½¿ç”¨<code class="highlighter-rouge">systemctl enable</code></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl enable pbs_server 
systemctl enable pbs_sched
systemctl enable pbs_mom
</code></pre></div></div>
<h2 id="æ‰“åŒ…ç”Ÿæˆä¸ªèŠ‚ç‚¹å®‰è£…åŒ…">æ‰“åŒ…ï¼Œç”Ÿæˆä¸ªèŠ‚ç‚¹å®‰è£…åŒ…</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make packages
</code></pre></div></div>

<h2 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qterm
./torque.setup root
</code></pre></div></div>
<blockquote>
  <p>qtermä¸ºç»ˆæ­¢pbs_serverçš„è¿è¡Œ,è‹¥ä¸ç»ˆæ­¢ï¼Œæ— æ³•åˆå§‹åŒ–
<br />æœ‰æ•™ç¨‹ä¸­è¯´rootåº”ä¸ºæ™®é€šç”¨æˆ·å
<br />å¦‚æœ<code class="highlighter-rouge">/etc/hosts</code>ä¸­ä¸»æœºåæ”¾åœ¨åˆ«ååé¢ï¼Œä¼šæŠ¥é”™</p>
  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qmgr obj= svr=default: Bad ACL entry in host list MSG=First bad host: VM_10_194_centos
ERROR: cannot set root@VM_10_194_centos in operators list
</code></pre></div>  </div>
</blockquote>

<h2 id="å¯åŠ¨ç¨‹åº">å¯åŠ¨ç¨‹åº</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in pbs_server pbs_sched pbs_mom ; do service $i restart; done
trqauthd
# centos7 è¿˜å¯ä»¥
for i in pbs_server pbs_sched pbs_mom ; do systemctl restart $i ; done
trqauthd
</code></pre></div></div>
<p><code class="highlighter-rouge">ps -e | grep pbs</code>å¯ä»¥æŸ¥çœ‹å¯åŠ¨æƒ…å†µ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@VM_10_194_centos cndaqiang]# ps -e | grep pbs
 8966 ?        00:00:00 pbs_server
 8987 ?        00:00:00 pbs_sched
 8995 ?        00:00:00 pbs_mom
</code></pre></div></div>
<h2 id="é…ç½®èŠ‚ç‚¹">é…ç½®èŠ‚ç‚¹</h2>
<h3 id="ç®¡ç†èŠ‚ç‚¹è°ƒåº¦èŠ‚ç‚¹master">ç®¡ç†èŠ‚ç‚¹(è°ƒåº¦èŠ‚ç‚¹,master)</h3>
<p><strong>æ³¨:</strong>,æ¯æ¬¡åˆå§‹åŒ–<code class="highlighter-rouge">./torque.setup &lt;username&gt;</code> ï¼Œä¼šæ¸…ç©ºç®¡ç†èŠ‚ç‚¹çš„é…ç½®ä¿¡æ¯,éœ€é‡æ–°é…ç½®<br />
ç»ˆæ­¢pbs_server</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qterm
</code></pre></div></div>
<p>ç¼–è¾‘<code class="highlighter-rouge">/var/spool/torque/server_priv/nodes</code>ï¼Œå¡«å…¥ç®¡ç†èŠ‚ç‚¹ä¸»æœºå,å¦‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>VM_10_194_centos np=8 normal
#æŒ‡å®šèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„è¿›ç¨‹æ•°ç›®ï¼ŒèŠ‚ç‚¹å±æ€§
</code></pre></div></div>
<h3 id="è®¡ç®—èŠ‚ç‚¹">è®¡ç®—èŠ‚ç‚¹</h3>
<p>ç¼–è¾‘<code class="highlighter-rouge">/var/spool/torque/mom_priv/config</code>ï¼Œå¡«å…¥</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$pbsserver VM_10_194_centos
$logevent 255
</code></pre></div></div>
<p>é‡å¯</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in pbs_server pbs_sched pbs_mom ; do service $i restart; done
trqauthd
</code></pre></div></div>
<p>æŸ¥çœ‹èŠ‚ç‚¹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@VM_10_194_centos cndaqiang]# qnodes
VM_10_194_centos
     state = free
     power_state = Running
     np = 1
     ntype = cluster
     status = opsys=linux,uname=Linux VM_10_194_centos 3.10.0-514.21.1.el7.x86_64 #1 SMP Thu May 25 17:04:51 UTC 2017 x86_64,sessions=10148,nsessions=1,nusers=1,idletime=48030,totmem=3113664kb,availmem=2808244kb,physmem=1016516kb,ncpus=1,loadave=0.00,gres=,netload=2164774121,state=free,varattr= ,cpuclock=Fixed,version=6.1.1.1,rectime=1515722674,jobs=
     mom_service_port = 15002
     mom_manager_port = 15003
</code></pre></div></div>

<h3 id="è®¡ç®—èŠ‚ç‚¹é…ç½®">è®¡ç®—èŠ‚ç‚¹é…ç½®</h3>
<p>ç”±äºè¿™æ¬¡æ˜¯å•æœº,è®¡ç®—èŠ‚ç‚¹å’Œç®¡ç†èŠ‚ç‚¹åœ¨åŒä¸€æœºå™¨ï¼Œå¾ˆå¤šé›†æƒè®¡ç®—èŠ‚ç‚¹çš„é…ç½®ä¸ç”¨åšäº†<br />
å®‰è£…è½¯ä»¶åŒ…</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./torque-package-clients-linux-x86_64.sh --install  
./torque-package-mom-linux-x86_64.sh --install
</code></pre></div></div>
<p>é‡å¯</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in pbs_server pbs_sched pbs_mom ; do service $i restart; done
trqauthd
</code></pre></div></div>

<h3 id="åˆ›å»ºé˜Ÿåˆ—">åˆ›å»ºé˜Ÿåˆ—</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@VM_10_194_centos torque]# qmgr
Max open servers: 9
Qmgr:  creat queue normal queue_type=execution
Qmgr:  set server default_queue=normal
Qmgr:  set queue normal started=true 
Qmgr:  set queue normal enabled=true
Qmgr:  set server scheduling=true
Qmgr:  (ctrl+dé€€å‡º)
</code></pre></div></div>
<p>é‡å¯</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in pbs_server pbs_sched pbs_mom ; do service $i restart; done
</code></pre></div></div>
<h3 id="æ³¨">æ³¨</h3>
<p>æ¯æ¬¡ç®¡ç†èŠ‚ç‚¹å¼€æœº,éƒ½éœ€è¦</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trqauthd
</code></pre></div></div>
<p>å’Œé‡æ–°åˆ›å»ºé˜Ÿåˆ—</p>

<h2 id="æµ‹è¯•æäº¤ä»»åŠ¡qsub">æµ‹è¯•æäº¤ä»»åŠ¡<code class="highlighter-rouge">qsub</code></h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@VM_10_194_centos torque]# su cndaqiang
[cndaqiang@VM_10_194_centos torque]$ echo "sleep 30" |qsub
8.localhost
[cndaqiang@VM_10_194_centos torque]$ qstat
Job ID                    Name             User            Time Use S Queue
------------------------- ---------------- --------------- -------- - -----
8.localhost                STDIN            cndaqiang              0 R normal         
[cndaqiang@VM_10_194_centos torque]$ qstat
Job ID                    Name             User            Time Use S Queue
------------------------- ---------------- --------------- -------- - -----
8.localhost                STDIN            cndaqiang       00:00:00 C normal
</code></pre></div></div>
<p>30ç§’åï¼ŒçŠ¶æ€ç”±<code class="highlighter-rouge">R</code>runå˜ä¸ºäº†<code class="highlighter-rouge">C</code>complete</p>

<h1 id="ä½¿ç”¨">ä½¿ç”¨</h1>
<p>è¯¥éƒ¨åˆ†ä¸»è¦å‚è€ƒ
<br /><a href="http://hydro.igsnrr.ac.cn/data/resources/PBS.pdf">PBS</a>
<br /><a href="http://blog.sciencenet.cn/blog-478347-395684.html">[è½¬è½½]PBSï¼ï¼</a></p>
<h2 id="å‘½ä»¤">å‘½ä»¤</h2>
<ul>
  <li>æäº¤è„šæœ¬
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qsub &lt;PBSä½œä¸šè„šæœ¬&gt;
</code></pre></div>    </div>
  </li>
  <li>æŸ¥è¯¢ä½œä¸šçŠ¶æ€
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@centos1:~$ qstat
Job ID                    Name             User            Time Use S Queue
------------------------- ---------------- --------------- -------- - -----
8.centos1                  STDIN            cndaqiang              0 R normal
</code></pre></div>    </div>
    <p>çŠ¶æ€:Eé€€å‡º,Qæ’é˜Ÿ,HæŒ‚èµ·,Rè¿è¡Œ,Cç»“æŸ</p>
  </li>
  <li>åˆ é™¤ä½œä¸š
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qdel &lt;Job ID&gt;
</code></pre></div>    </div>
  </li>
  <li>æŒ‚èµ·ä½œä¸š
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qhold &lt;Job ID&gt;
</code></pre></div>    </div>
  </li>
  <li>å–æ¶ˆæŒ‚èµ·
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qrls &lt;Job ID&gt;
</code></pre></div>    </div>
  </li>
  <li>äº¤æ¢ä½œä¸šé¡ºåº
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qorder &lt;Job ID&gt; &lt;Job ID&gt;
</code></pre></div>    </div>
  </li>
  <li>qstat
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qstat æŸ¥çœ‹æœ€è¿‘ä½œä¸šçŠ¶æ€
qstat -f &lt;Job ID&gt; æŸ¥çœ‹ä½œä¸šä¿¡æ¯(ä½œä¸šæäº¤å¤šäº†ï¼Œå¿˜è®°æ˜¯ä»€ä¹ˆå¿…å¤‡)
qstat -n &lt;Job ID&gt; æŸ¥çœ‹ä½œä¸šèŠ‚ç‚¹
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="pbsè„šæœ¬æ–‡ä»¶">PBSè„šæœ¬æ–‡ä»¶</h2>
<h3 id="è¯´æ˜">è¯´æ˜</h3>
<ul>
  <li>æœ¬è´¨æ˜¯ä¸€ä¸ªSHELLè„šæœ¬,å’Œbashè¯­æ³•ç›¸åŒ,å¯ç›´æ¥è°ƒç”¨shellå‘½ä»¤</li>
  <li><code class="highlighter-rouge">#</code>å¼€å¤´æ³¨é‡Š</li>
  <li><code class="highlighter-rouge">#PBS</code>å¼€å¤´æ˜¯PBSè¿è¡Œå‚æ•°</li>
  <li>ç¯å¢ƒå˜é‡
<br />ç±»ä¼¼äºPHPçš„é­”æœ¯å˜é‡(é¢„å®šä¹‰å¸¸é‡)
<img src="/uploads/2018/01/pbs.png" alt="" /></li>
</ul>

<h3 id="pbsè¿è¡Œå‚æ•°">PBSè¿è¡Œå‚æ•°</h3>
<p>å¯ä»¥åœ¨<code class="highlighter-rouge">qsub è¿è¡Œå‚æ•° &lt;ä½œä¸šè„šæœ¬&gt;</code>ä¸­è®¾ç½®<br />
ä¹Ÿå¯ä»¥åœ¨è„šæœ¬ä¸­ä»¥<code class="highlighter-rouge">#PBS è¿è¡Œå‚æ•°</code>è®¾ç½®<br />
<code class="highlighter-rouge">qsub è¿è¡Œå‚æ•° &lt;ä½œä¸šè„šæœ¬&gt;</code>è®¾ç½®çš„ä¼˜å…ˆçº§æ›´é«˜<br />
è¯¦ç»†å‚æ•°è®¾ç½®
<img src="/uploads/2018/01/pbs2.png" alt="" /></p>

<h3 id="è¿è¡Œvaspç¤ºä¾‹">è¿è¡ŒVASPç¤ºä¾‹</h3>
<p>å‚è€ƒ<a href="http://cist.bnu.edu.cn/docs/20150427050417757608.docx">åŒ—å¸ˆ-æ™®é€šç”¨æˆ·ç”¨pbsæäº¤ä½œä¸šæ“ä½œæ‰‹å†Œ</a></p>

<p><strong>pbsè„šæœ¬ä¸­ç”¨ä¸­æ–‡æ³¨é‡Šä¼šæŠ¥é”™</strong><code class="highlighter-rouge">qsub:  file must be an ascii script</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#####PBSå‚æ•°è®¾ç½®#####
#PBS -N vasp
#ç¨‹åºå
#PBS -l nodes=1:ppn=3
#èŠ‚ç‚¹,æ¯ä¸ªèŠ‚ç‚¹æ ¸æ•°
#PBS -l walltime=1:00:00:00
#ä½œä¸šè¿è¡Œæœ€å¤§æ—¶é—´1å¤©ï¼Œä¼°ç®—è‡ªå·±çš„ä½œä¸šæœ€å¤§è¿è¡Œæ—¶é—´ï¼Œè¿™é‡ŒæŒ‡å®šä¸€ä¸‹
#PBS -q batch
# æ·»åŠ åˆ°é˜Ÿåˆ—batch
#PBS -V
#å®šä¹‰ç¯å¢ƒå˜é‡èŒƒå›´
#PBS -S /bin/bash 

#####è®¾ç½®PATH#####
source /opt/intel/compilers_and_libraries_2018.0.128/linux/bin/compilervars.sh intel64
source /opt/intel/compilers_and_libraries_2018.0.128/linux/bin/iccvars.sh intel64 
source /opt/intel/compilers_and_libraries_2018.0.128/linux/bin/ifortvars.sh intel64 
source /opt/intel/compilers_and_libraries/linux/mkl/bin/mklvars.sh intel64
source  /opt/intel/impi/2018.0.128/bin64/mpivars.sh

#####è®¡ç®—#####
cd $PBS_O_WORKDIR
#è¿›å…¥å·¥ä½œç›®å½•
EXEC=/home/cndaqiang/soft/vasp.5.4.1/build/std/vasp
#vasp
NP=`cat $PBS_NODEFILE | wc -l`
#wc -l ç»Ÿè®¡è¡Œæ•°
#NPä¸º mpirunè¿è¡Œçš„np(number of processes,),æ ¸æ•°
NN=`cat $PBS_NODEFILE | sort | uniq | tee /tmp/cqiang_nodes.$$ | wc -l`
#sortæ’åº,uniqå»é™¤é‡å¤,teeé‡å®šå‘è¾“å‡º,$$ä»£è¡¨shellæœ¬èº«çš„PID
#NNä¸ºèŠ‚ç‚¹æ•°
cat $PBS_NODEFILE &gt; /tmp/cqiang_nodefile.$$
#å­˜å‚¨èŠ‚ç‚¹è¿›ç¨‹ä¿¡æ¯
mpirun -genv I_MPI_DEVICE rdssm -machinefile /tmp/cqiang_nodefile.$$ -n $NP $EXEC
# -machinefile :æŒ‡å®šåŠ å…¥è¿ç®—çš„èµ„æº
# -nolocal :æœ¬æœºå™¨ä¸å‚ä¸è¿ç®—
# -np :å¤„ç†å™¨æ•°é‡

rm -rf /tmp/cqiang_nodefile.$$
rm -rf /tmp/cqiang_nodes.$$
</code></pre></div></div>
<p>å°†è„šæœ¬æ”¾äºvaspè¾“å…¥æ–‡ä»¶åŒä¸€ç›®å½•</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qsub &lt;è„šæœ¬å&gt;
</code></pre></div></div>
<p>å³å¯è¿è¡Œ</p>

:ET