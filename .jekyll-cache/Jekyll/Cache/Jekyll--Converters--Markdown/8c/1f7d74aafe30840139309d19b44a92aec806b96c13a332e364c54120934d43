I"Êw<ul id="markdown-toc">
  <li><a href="#å‚è€ƒ" id="markdown-toc-å‚è€ƒ">å‚è€ƒ</a></li>
  <li><a href="#æ³¨æ„" id="markdown-toc-æ³¨æ„">æ³¨æ„</a></li>
  <li><a href="#pwscf" id="markdown-toc-pwscf">PWscf</a></li>
  <li><a href="#ppæ¨¡å—" id="markdown-toc-ppæ¨¡å—">PPæ¨¡å—</a></li>
  <li><a href="#pwscfsaveæ–‡ä»¶å¤¹" id="markdown-toc-pwscfsaveæ–‡ä»¶å¤¹">pwscf.saveæ–‡ä»¶å¤¹</a></li>
  <li><a href="#ç¤ºä¾‹" id="markdown-toc-ç¤ºä¾‹">ç¤ºä¾‹</a>    <ul>
      <li><a href="#è‹¯åˆ†å­çš„scfè®¡ç®—å’Œè½¨é“psiikiband2å±•ç¤º" id="markdown-toc-è‹¯åˆ†å­çš„scfè®¡ç®—å’Œè½¨é“psiikiband2å±•ç¤º">è‹¯åˆ†å­çš„scfè®¡ç®—å’Œè½¨é“<code class="highlighter-rouge">|psi(ik,iband)|^2</code>å±•ç¤º</a></li>
      <li><a href="#çŸ³å¢¨çƒ¯doså’Œèƒ½å¸¦" id="markdown-toc-çŸ³å¢¨çƒ¯doså’Œèƒ½å¸¦">çŸ³å¢¨çƒ¯DOSå’Œèƒ½å¸¦</a>        <ul>
          <li><a href="#dosè®¡ç®—scfpwx-nscfpwx-dosx" id="markdown-toc-dosè®¡ç®—scfpwx-nscfpwx-dosx">DOSè®¡ç®—scf(pw.x)-&gt;nscf(pw.x)-&gt;dos.x</a></li>
          <li><a href="#èƒ½å¸¦è®¡ç®—scfpwx-bandspwx-bandsx" id="markdown-toc-èƒ½å¸¦è®¡ç®—scfpwx-bandspwx-bandsx">èƒ½å¸¦è®¡ç®—scf(pw.x)-&gt;bands(pw.x)-&gt;bands.x</a></li>
        </ul>
      </li>
      <li><a href="#siçŠ¶æ€æ–¹ç¨‹" id="markdown-toc-siçŠ¶æ€æ–¹ç¨‹">SiçŠ¶æ€æ–¹ç¨‹</a>        <ul>
          <li><a href="#çŠ¶æ€æ–¹ç¨‹evx" id="markdown-toc-çŠ¶æ€æ–¹ç¨‹evx">çŠ¶æ€æ–¹ç¨‹ev.x</a></li>
        </ul>
      </li>
      <li><a href="#alé‡‘å±ä½“ç³»" id="markdown-toc-alé‡‘å±ä½“ç³»">Alé‡‘å±ä½“ç³»</a>        <ul>
          <li><a href="#scfè®¡ç®—" id="markdown-toc-scfè®¡ç®—">scfè®¡ç®—</a></li>
          <li><a href="#ç”µè·å¯†åº¦" id="markdown-toc-ç”µè·å¯†åº¦">ç”µè·å¯†åº¦</a></li>
        </ul>
      </li>
      <li><a href="#feç£æ€§ææ–™" id="markdown-toc-feç£æ€§ææ–™">Feç£æ€§ææ–™</a>        <ul>
          <li><a href="#é“ç£fmåé“ç£afmè®¡ç®—" id="markdown-toc-é“ç£fmåé“ç£afmè®¡ç®—">é“ç£FMï¼Œåé“ç£AFMè®¡ç®—</a></li>
          <li><a href="#dos" id="markdown-toc-dos">DOS</a></li>
          <li><a href="#pdos-projwfcx" id="markdown-toc-pdos-projwfcx">PDOS projwfc.x</a></li>
        </ul>
      </li>
      <li><a href="#feo-dftu" id="markdown-toc-feo-dftu">FeO DFT+U</a>        <ul>
          <li><a href="#ä¸åŠ u" id="markdown-toc-ä¸åŠ u">ä¸åŠ U</a></li>
          <li><a href="#åŠ u" id="markdown-toc-åŠ u">åŠ U</a></li>
          <li><a href="#åŠ u--starting_ns_eigenvaluemispinityp" id="markdown-toc-åŠ u--starting_ns_eigenvaluemispinityp">åŠ U &amp; starting_ns_eigenvalue(m,ispin,ityp)</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>æœ¬å­¦ä¹ æ•™ç¨‹å†…å®¹ä¸»è¦æ¥è‡ªäº’è”ç½‘ï¼Œä¸ªäººå­¦ä¹ è®°å½•ï¼Œä»…ä¾›å‚è€ƒã€‚<br />
ä»£ç ä»“åº“<a href="https://github.com/cndaqiang/LearnQE">LearnQE@cndaqiang</a></p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p><a href="http://qe2019.ijs.si/">Summer School on Advanced Materials and Molecular Modelling</a><br />
<a href="https://gitlab.com/QEF/material-for-ljubljana-qe-summer-school">GitLab for qe2019</a><br /></p>

<h2 id="æ³¨æ„">æ³¨æ„</h2>
<ul>
  <li>æ¯ä¸ªæ¨¡å—ä¸‹é¢éƒ½æœ‰Exampleå’ŒManualï¼Œå¦‚<code class="highlighter-rouge">PP/Doc/user_guide.pdf</code></li>
  <li>é»˜è®¤èµåŠ¿è·¯å¾„è®¾ç½®<code class="highlighter-rouge">export ESPRESSO_PSEUDO=/home/cndaqiang/ONCVPSP/abinit</code></li>
  <li>é»˜è®¤outdir<code class="highlighter-rouge">export ESPRESSO_TMPDIR=</code></li>
  <li><strong>USPP, it is typically needed to set ecutrho &gt; 4Ã—ecutwfc (it should be at least 8 to 12 times larger)</strong></li>
</ul>

<h2 id="pwscf">PWscf</h2>
<ul>
  <li>Molecule/Cluster ä½“ç³»è¦è®¾ç½®<code class="highlighter-rouge">assume_isolated</code>å‚æ•°</li>
  <li>kç‚¹è¾ƒå¤š(&gt;100)æ—¶ï¼Œè®¾ç½®<code class="highlighter-rouge">verbosity='high'</code>è¾“å‡ºæ›´å¤šä¿¡æ¯</li>
  <li>åŒä¸€å…ƒç´ æœ‰å¤šç§ç£çŸ©æ—¶ï¼Œè¦ä½¿ç”¨ä¸åŒçš„æ ‡ç­¾(Fe1,Fe2)ï¼Œå› ä¸º<strong>åˆå§‹ç£çŸ©å’Œntypå¯¹åº”ï¼Œ<code class="highlighter-rouge">starting_magnetization(1:ntyp)</code></strong></li>
</ul>

<h2 id="ppæ¨¡å—">PPæ¨¡å—</h2>
<p>å¯æ‰§è¡Œç¨‹åº</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@girl:~/code/tdpw2.0/q-e-qe-6.4.1-devel-1.0/PP/src$ ls *.x
average.x         fs.x             plotband.x  projwfc.x       wannier_ham.x
bands.x           initial_state.x  plotproj.x  pw2bgw.x        wannier_plot.x
dos.x             molecularpdos.x  plotrho.x   pw2critic.x     wfck2r.x
epsilon.x         open_grid.x      pmw.x       pw2gw.x
fermi_proj.x      pawplot.x        ppacf.x     pw2wannier90.x
fermi_velocity.x  plan_avg.x       pp.x        sumpdos.x
</code></pre></div></div>
<p>pp.x,åå¤„ç†pw.xå’Œcp.xçš„è®¡ç®—ç»“æœï¼Œ<strong>è®¡ç®—ä¸€äº›ç‰©ç†æ€§è´¨ç”¨äºç”»å›¾</strong>ï¼Œå›¾å½¢æœ‰1D,2D,3Dç±»å‹,å¯ä»¥æŒ‡å®šè¾“å‡ºæ ¼å¼(å¦‚xsf),è¾“å‡ºå¯ä»¥è¢«ä¸‹åˆ—ç¨‹åºå¤„ç†</p>
<ul>
  <li>Gnuplot (1D or 2D plots),</li>
  <li>by code plotrho.x that comes with PostProc and produces PostScript 2D plots,</li>
  <li>by advanced plotting software XCrySDen and gOpenMol (3D plots).</li>
</ul>

<p>ä¹Ÿå¯ä»¥è¾“å‡ºå…¶ä»–è¿ç®—(å¦‚pw.x -&gt; pp.x -&gt; average.x)éœ€è¦çš„è¾“å…¥<br />
å¤„ç†çš„æ€§è´¨æœ‰</p>
<ul>
  <li>charge density</li>
  <li>spin polarization</li>
  <li>various potentials</li>
  <li>local density of states at EF</li>
  <li>local density of electronic entropy</li>
  <li>STM images</li>
  <li>selected squared wavefunction</li>
  <li>ELF (electron localization function)</li>
  <li>RDG (reduced density gradient)</li>
  <li>integrated local density of states</li>
</ul>

<h2 id="pwscfsaveæ–‡ä»¶å¤¹">pwscf.saveæ–‡ä»¶å¤¹</h2>
<ul>
  <li>
    <p>scfè®¡ç®—ï¼Œè¾“å‡ºæ–‡ä»¶pwscf.saveï¼š
<br /> 1. wfcæ³¢å‡½æ•°, dwè‡ªæ—‹down,upè‡ªæ—‹up,è‹¥ç”¨scfçš„ç»“æœè®¡ç®—pdosæœ‰ç”¨
<br /> <code class="highlighter-rouge">wfcdw[1-nkstot].dat  wfcup[1-nkstot].dat</code>
<br /> <strong>2. ç”µè·å¯†åº¦ï¼Œå¾ˆæœ‰ç”¨ï¼Œä»…åœ¨scfè®¡ç®—ï¼Œnscfä¸è®¡ç®—</strong>ï¼Œnscf,pdosç­‰åå¤„ç†éœ€è¦
<br /> <code class="highlighter-rouge">charge-density.dat</code>
<br /> <strong>3. è®¡ç®—å‚æ•°å’Œè¾“å‡º,nscféœ€è¦ä»è¿™é‡Œè¯»å…¥åŸå­ç»“æ„</strong>
<br /> <code class="highlighter-rouge">data-file-schema.xml</code>
<br /> 4. èµåŠ¿
<br /> <code class="highlighter-rouge">Fe_ONCV_PBE_sr.upf</code></p>
  </li>
  <li>nscfè®¡ç®—æ—¶ï¼Œ<strong>.inæ–‡ä»¶ä¸­çš„åŸå­ä½ç½®ä¼šè¢«å¿½ç•¥,ä½†æ˜¯å¾—æœ‰è¿™ä¸ªé€‰é¡¹å¡</strong>
    <blockquote>
      <p>Specified atomic positions will be IGNORED and those from the previous scf calculation will be used instead !!!</p>
    </blockquote>
  </li>
  <li>nscfè®¡ç®—ï¼Œè¾“å…¥æ–‡ä»¶pwscf.save:
<br /><code class="highlighter-rouge">charge-density.dat</code> <strong>æ¥è‡ªscfè®¡ç®—</strong>
<br /><code class="highlighter-rouge">data-file-schema.xml</code> æ¥è‡ªnscfæˆ–scfè®¡ç®—ï¼Œè¯»å…¥ç»“æ„å‚æ•°ç­‰ä¿¡æ¯,ç®—å®Œè¦†ç›–
<br /> ä¿®æ”¹å…¶ä¸­çš„<code class="highlighter-rouge">&lt;output&gt;</code>é€‰é¡¹å¡ï¼Œä¾¿å¯è°ƒèŠ‚åŸå­ç»“æ„ç­‰å‚æ•°è¿›è¡Œæµ‹è¯•(çç®—)
<img src="/uploads/2020/03/xml.png" alt="" /></li>
  <li>
    <p>nscfè®¡ç®—,è¾“å‡ºæ–‡ä»¶pwscf.saveï¼š
<br /> <strong>1. pdos éœ€è¦è¯»å…¥ï¼Œæœ‰ç”¨</strong>
<br /> <code class="highlighter-rouge">wfcdw[1-nkstot].dat  wfcup[1-nkstot].dat</code>
<br /> <strong>2. è®¡ç®—å‚æ•°å’Œè¾“å‡º,nscféœ€è¦ä»è¿™é‡Œè¯»å…¥åŸå­ç»“æ„</strong>
<br /> <code class="highlighter-rouge">data-file-schema.xml</code>
<br /> 3. èµåŠ¿
<br /> <code class="highlighter-rouge">Fe_ONCV_PBE_sr.upf</code></p>
  </li>
  <li>
    <p>pdosè¾“å…¥éœ€è¦pwscf.save:
<br /><code class="highlighter-rouge">charge-density.dat</code> <strong>æ¥è‡ªscfè®¡ç®—</strong>
<br /><code class="highlighter-rouge">wfcdw[1-nkstot].dat  wfcup[1-nkstot].dat</code> æ¥è‡ªnscfæˆ–scfè®¡ç®—(å³scfå’Œnscfçš„ç»“æœéƒ½å¯ä»¥ç”¨äºè®¡ç®—pdos)
<br /><code class="highlighter-rouge">data-file-schema.xml</code> æ¥è‡ªnscfæˆ–scfè®¡ç®—ï¼Œè¯»å…¥ç»“æ„å‚æ•°ç­‰ä¿¡æ¯</p>
  </li>
  <li>pdosè¾“å‡ºpwscf.save:
<br /><code class="highlighter-rouge">atomic_proj.xml</code></li>
</ul>

<h2 id="ç¤ºä¾‹">ç¤ºä¾‹</h2>
<h3 id="è‹¯åˆ†å­çš„scfè®¡ç®—å’Œè½¨é“psiikiband2å±•ç¤º">è‹¯åˆ†å­çš„scfè®¡ç®—å’Œè½¨é“<code class="highlighter-rouge">|psi(ik,iband)|^2</code>å±•ç¤º</h3>

<p>å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-1/example1.benzene
</code></pre></div></div>
<p>SCFè®¡ç®—</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.benzene.scf.in | tee pw.out
</code></pre></div></div>
<p>PPå¤„ç†</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pp.x -i pp.benzene.psi2.in | tee pp.out
</code></pre></div></div>
<p>PPä»…éœ€è¦<code class="highlighter-rouge">outdir/prefix.save</code>æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼Œå…¶ä»–SCFè®¡ç®—è¾“å‡ºä¸éœ€è¦å­˜åœ¨ï¼Œ<br />
<code class="highlighter-rouge">cp AAA.save BBB.save</code>åï¼Œåœ¨pp.inä¸­è®¾ç½®<code class="highlighter-rouge">prefix    =  'BBB'</code>ä¹Ÿå¯ä»¥</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &amp;INPUTPP
    !è¾“å…¥æ•°æ®outdir/prefix.save
    prefix    =  'test',
    !outdir    =  '/tmp',

    !å¤„ç†ä¿å­˜åˆ°filplot_XXXï¼Œç”¨äºåç»­å¤„ç†
    filplot   =  'pp.psi2',

    !plot_num,ç”»å›¾çš„ç‰©ç†é‡ï¼Œæ›´å¤šé€‰é¡¹INPUT_PP.html
    plot_num  =  7,
    !ä¸åŒçš„plot_numå¯¹åº”ä¸åŒå‚æ•°ï¼Œä¸‹é¢ä¸ºplot_num = 7ï¼Œç”»psi^2æ—¶çš„é€‰é¡¹
    !plot_num = 7 è¾“å‡º filplot_KXXX_BXXX, K kç‚¹, B band.
    kpoint    =  1,  !è‡ªæ—‹
    kband(1)  =  1,  !ç”»band [kband(1),kband(2)]
    kband(2)  =  16,  
    lsign     =  .true.,  !if true and k point is Gamma, plot |psi|^2 sign(psi)
 /

!å¯ä»¥ä¸æŒ‡å®šPLOT namelistï¼Œå°±ä¸ä¼šè¾“å‡ºé¢å¤–çš„å›¾å½¢æ•°æ®
!ä»INPUTPPçš„è¾“å‡ºåç»­å¤„ç†
&amp;PLOT
   fileout       =  '.xsf', !æ‹“å±•å
   iflag         =  3, !å›¾å½¢ç»´åº¦
   nfile         =  1, !è¾“å…¥æ–‡ä»¶æ•°é‡
   output_format =  5, !è¾“å‡ºæ–‡ä»¶æ ¼å¼,5 =&gt; format suitable for XCRYSDEN  (2D or user-supplied 3D region)
   weight(1)     =  1.0, !å„è¾“å…¥æ–‡ä»¶æƒé‡
/

</code></pre></div></div>
<p>ä½¿ç”¨xcrysdenæ‰“å¼€xsfæ ¼å¼</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcrysden --xsf pp.psi2_K001_B001.xsf
</code></pre></div></div>
<p>é€‰å®šç»˜å›¾æ•°æ®:<br />
é€‰æ‹©xcrysdençš„<strong>Tools/Data Grid</strong>é€‰é¡¹,å¯ä»¥æŸ¥çœ‹è¾“å…¥æ–‡ä»¶åŒ…å«çš„æ•°æ®é‡ï¼Œå¯ä»¥åˆ†åˆ«æŒ‡å®šæƒé‡ï¼Œç„¶åç‚¹<strong>OK</strong><br />
(æ­¤å¤„åªæœ‰ä¸€ä¸ªæ•°æ®)<br />
ä¸‹é¢å¼€å§‹è°ƒèŠ‚ç”»å›¾,è®¾ç½®Isovalueï¼Œç‚¹å‡»<strong>Submit</strong>
<img src="/uploads/2020/03/3dgrid.png" alt="" />
<strong>æ‰¹é‡ç»˜å›¾</strong><br />
<strong>File/Save Current State</strong>æˆ–<code class="highlighter-rouge">ctrl+u</code>,ä¿å­˜æ“ä½œåˆ°<code class="highlighter-rouge">state.xcrysden</code><br />
ä½¿ç”¨å·²ä¿å­˜çš„æ“ä½œæ‰“å¼€æ–°æ–‡ä»¶</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcrysden --xsf pp.psi2_K001_B002.xsf --script state.xcrysden 
</code></pre></div></div>
<p>ç›´æ¥ä¿å­˜æˆå›¾ç‰‡æ ¼å¼,ä¸‹é¢è„šæœ¬ä¼šè‡ªåŠ¨æ‰“å¼€xcrysdenç”»å›¾ï¼Œå¯ä»¥ç”¨äºæ‰¹å¤„ç†</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcrysden --xsf pp.psi2_K001_B002.xsf --script state.xcrysden --print 2.png
</code></pre></div></div>
<p>ç¬”è®°æœ¬ä¸Šæ˜¾ç¤ºçš„å±…ç„¶æ˜¯è¿™æ ·çš„,åº”è¯¥æ˜¯å¯¹xcrysdençª—å£çš„æˆªå›¾ï¼Œåˆ†è¾¨ç‡ç­‰åŸå› ä½¿å¾—è°ƒèŠ‚çª—å£è¦†ç›–äº†æ˜¾ç¤ºçª—å£ï¼Œæˆªå›¾å‡ºé”™
ç­‰å¾…åç»­è§£å†³æ–¹æ¡ˆ
<img src="/uploads/2020/03/fenbian.png" alt="" />
<br />xsfæ ¼å¼ä¹Ÿå¯ä»¥ç”¨VESTAæ‰“å¼€ï¼Œæ›´ç¾è§‚
<img src="/uploads/2020/03/vesta.png" alt="" /></p>

<h3 id="çŸ³å¢¨çƒ¯doså’Œèƒ½å¸¦">çŸ³å¢¨çƒ¯DOSå’Œèƒ½å¸¦</h3>
<p>å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-1/example2.graphene
</code></pre></div></div>
<h4 id="dosè®¡ç®—scfpwx-nscfpwx-dosx">DOSè®¡ç®—scf(pw.x)-&gt;nscf(pw.x)-&gt;dos.x</h4>
<p>SCFè®¡ç®—</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.graphene.scf.in | tee scf.out
</code></pre></div></div>
<p>nscfè®¡ç®—/DOSè®¡ç®— <code class="highlighter-rouge">calculation = 'nscf'</code> <br />
è®¾ç½®<code class="highlighter-rouge">occupations='tetrahedra'</code>,è¿™åŒVASPç­‰DFTç¨‹åºä¸€æ ·ï¼Œç®—DOSé‡‡ç”¨Blochlä¿®æ­£çš„å››é¢ä½“æ–¹æ³•ï¼Œä½†æ˜¯æ­¤æ–¹æ³•ä¸èƒ½ç”¨æ¥ç®—åŠ›å­¦æ€§è´¨</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.graphene.nscf.in | tee nscf.out
</code></pre></div></div>
<p>DOSåå¤„ç†ï¼Œå¯è§†åŒ–dos.x</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dos.x -i dos.graphene.in | tee dos.out
./dos.py
</code></pre></div></div>
<p>åŒpp.xä¸€æ ·ï¼Œé»˜è®¤ä¼šä»<code class="highlighter-rouge">otudir/prefix.save</code>ä¸­è¯»å–æ•°æ®è¿›è¡Œå¤„ç†pw.x<br />
scfçš„è®¡ç®—ç»“æœä¹Ÿå¯ä»¥ç”¨æ¥å¤„ç†</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &amp;DOS
    prefix = 'pwscf',
    ! otudir = '/tmp'
    !è¿™å‡ ä¸ªä¿æŒé»˜è®¤å°±å¥½äº†ï¼Œç®—æ³•ä¸Šçš„é€‰æ‹©
    !bz_sum
    !ngauss
    !degauss
    !èƒ½é‡åŒºé—´å’Œæ­¥é•¿
    !Emin
    !Emax
    !DeltaE
    !ä¿å­˜åˆ°fildos
    fildos = 'graphene.dos'
 /
</code></pre></div></div>
<p>è™½ç„¶ncsfå’Œscfçš„ç»“æœéƒ½å¯ä»¥ç”¨æ¥ç”»DOSï¼Œä½†åŒºåˆ«è¿˜æ˜¯æœ‰çš„ï¼Œå¦‚å›¾<br />
scf(kpoints 9x9x1 smearing)<br />
nscf(kpoints 12x12x1 tetrahedra)<br />
<img src="/uploads/2020/03/dos.png" alt="" /></p>

<h4 id="èƒ½å¸¦è®¡ç®—scfpwx-bandspwx-bandsx">èƒ½å¸¦è®¡ç®—scf(pw.x)-&gt;bands(pw.x)-&gt;bands.x</h4>
<p>SCFè®¡ç®—</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.graphene.scf.in | tee scf.out
</code></pre></div></div>
<p>èƒ½å¸¦è®¡ç®—<code class="highlighter-rouge">calculation = 'nscf'</code> <br />
<strong>kç‚¹è·¯å¾„çš„é€‰æ‹©</strong><br />
xcrystalæ‰“å¼€pwscfç»“æ„,<strong>Tools/k-path Selection</strong><br />
å·¦é”®æ—‹è½¬ï¼Œå³é”®é€‰ä¸­é«˜å¯¹ç§°ç‚¹ï¼Œ<strong>OK</strong>,ä¿å­˜æ ¼å¼é€‰æ‹©pwscf<br />
pw.xè®¡ç®—bandsæ—¶çš„kç‚¹è®¾ç½®ç¤ºä¾‹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>K_POINTS {crystal_b}
3!é«˜å¯¹ç§°ç‚¹æ•°
   0.0000000000     0.0000000000     0.0000000000     40 !æ­¤kç‚¹åˆ°ä¸‹ä¸€kç‚¹çš„ç‚¹æ•°
   0.6666666667    -0.3333333333     0.0000000000     20
   0.5000000000    -0.5000000000     0.0000000000     0
</code></pre></div></div>
<p>è®¡ç®—</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.graphene.bands.in | tee pw.bands.out
</code></pre></div></div>
<p>èƒ½å¸¦åå¤„ç†ï¼Œå¯è§†åŒ–bands.x</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bands.x -i bands.graphene.in | tee bands.out
</code></pre></div></div>
<p>è¾“å‡ºæ–‡ä»¶</p>
<ul>
  <li>graphene.bands.dat.gnu # è·ç¦» EIG \n â€¦</li>
  <li>graphene.bands.dat     # kx,ky,kz \n EIG[1:nband]</li>
</ul>

<p>ä½¿ç”¨pyå¯¹graphene.bands.dat.gnuç”»å›¾</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bands.py
</code></pre></div></div>
<p>bands.graphene.in</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &amp;BANDS
    !è¯»å–outdir/pwscf
    prefix  = 'pwscf'
    ! otudir  = '/tmp/'
    !è¾“å‡ºæ–‡ä»¶filband
    filband = 'graphene.bands.dat'
    !spin_component = 1/2 !1 up, 2 down
    !lsigma #noncollinear case
    !
    !If lp = .true. matrix elements of the momentum operator p between conduction and valence bands
    !              are computed and written to file specified in filp
    !lp
    !filp
    
    lsym = .true.,
    !no_overlap 
    ! plot_2d  2Dæ ¼å¼ kx,ky,Energy
    !firstk
    !lastk
 /
</code></pre></div></div>
<p><img src="/uploads/2020/03/bands.png" alt="" /></p>

<p>å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨<code class="highlighter-rouge">plotband.x</code>å¤„ç†graphene.bands.datå¾—åˆ°çš„ç»“æœå’Œgraphene.bands.dat.gnuç±»ä¼¼</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@girl:example2.graphene$ plotband.x 
     Input file &gt; graphene.bands.dat
Reading    8 bands at     48 k-points
Range:  -18.9560   14.6190eV  Emin, Emax &gt; -18.9560   14.6190
high-symmetry point:  0.0000 0.0000 0.0000   x coordinate   0.0000
high-symmetry point:  0.3333 0.5774 0.0000   x coordinate   0.6667
high-symmetry point:  0.0000 0.5774 0.0000   x coordinate   1.0000
high-symmetry point:  0.0000 0.0000 0.0000   x coordinate   1.5773
output file (gnuplot/xmgr) &gt; plotband.dat.gnu        
bands in gnuplot/xmgr format written to file plotband.dat.gnu   
output file (ps) &gt; å›è½¦
stopping ...

</code></pre></div></div>

<h3 id="siçŠ¶æ€æ–¹ç¨‹">SiçŠ¶æ€æ–¹ç¨‹</h3>
<p>å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-1/example3.Si
</code></pre></div></div>
<h4 id="çŠ¶æ€æ–¹ç¨‹evx">çŠ¶æ€æ–¹ç¨‹ev.x</h4>
<p>ä½¿ç”¨PW/tools/ev.xå¯ä»¥è®¡ç®—çŠ¶æ€æ–¹ç¨‹ï¼Œç›´æ¥è¿è¡Œï¼Œè¾“å…¥ç›¸åº”å‚æ•°ï¼Œæ•°æ®æ–‡ä»¶ä¸¤åˆ—[a,E]</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@girl:example3.Si/ex3.alat/reference$ ev.x
     Lattice parameter or Volume are in (au, Ang) &gt; au
     Enter type of bravais lattice (fcc, bcc, sc, noncubic) &gt; fcc
     Enter type of equation of state :
     1=birch1, 2=birch2, 3=keane, 4=murnaghan &gt; 1
     Input file &gt; Etot-vs-alat.dat
     Output file &gt; out.dat
     Beware: file out.dat will be overwritten
cndaqiang@girl:example3.Si/ex3.alat/reference$ head out.dat
# equation of state: birch 1st order.  chisq =   0.5913D-07
# a0 = 10.2786 a.u., k0 =  915 kbar, dk0 =  3.96 d2k0 =  0.000 emin =  -15.80790
# a0 =  5.43921 Ang, k0 =  91.5 GPa,  V0 =   271.48 (a.u.)^3,  V0 =   40.23 A^3 

#########################################################################
# Lat.Par       E_calc        E_fit       E_diff    Pressure      Enthalpy
# a.u.            Ry           Ry            Ry        GPa           Ry
#########################################################################
  9.70000     -15.77943     -15.77927    -0.00016      22.46      -15.43108
  9.80000     -15.78874     -15.78890     0.00016      17.39      -15.51061
</code></pre></div></div>

<h3 id="alé‡‘å±ä½“ç³»">Alé‡‘å±ä½“ç³»</h3>
<p>å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-1/example4.Al
</code></pre></div></div>
<h4 id="scfè®¡ç®—">scfè®¡ç®—</h4>
<p>é‡‘å±ä½“ç³»å› ä¸ºè´¹ç±³é¢çš„åŸå› ï¼Œè¦è®¡ç®—å¾—å‡†ç¡®ï¼Œ<strong>ç›¸æ¯”åŠå¯¼ä½“éœ€è¦å¢åŠ Kç‚¹å¯†åº¦ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„degauss,smearing</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    occupations = 'smearing',
    smearing = 'm-v',
    degauss = 0.01
</code></pre></div></div>
<p>å¦‚<a href="http://qe2019.ijs.si/">Summer School on Advanced Materials and Molecular Modelling</a>çš„ç»“æœ<br />
<img src="/uploads/2020/03/qe2019al.png" alt="" /></p>

<h4 id="ç”µè·å¯†åº¦">ç”µè·å¯†åº¦</h4>
<p>scfè®¡ç®—</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@girl:example4.Al/ex2.chdens$ mpirun -np 4 pw.x -i pw.al.scf.in | tee scf.out
</code></pre></div></div>
<p>PPè®¡ç®—,xcrysdenæŸ¥çœ‹ï¼ŒæŸ¥çœ‹æ–¹æ³•ä¸å‰é¢çš„æŸ¥çœ‹xsfæ ¼å¼ç›¸åŒ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pp.x -i pp.charge.in 
xcrysden --xsf chargedensity.xsf 
</code></pre></div></div>
<p>PPè¾“å‡ºæ–‡ä»¶</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;INPUTPP
    prefix="pwscf"
    !filplot = "chargedensity"  !è¾“å‡ºç”¨äºåç»­å¤„ç†ï¼Œä¸å¿…é¡»è¾“å‡º
    plot_num = 17
    !plot_num = 17 ä»·ç”µå­ all-electron valence charge density
    !can be performed for PAW calculations only
    !requires a very dense real-space grid!
    !plot_num = 21 å…¨ç”µå­ all-electron charge density (valence+core).
    !spin_component = 0  !0 All, 1 up, 2 down
/
&amp;PLOT
    nfile = 1 
    weight(1)     =  1.0, !å„è¾“å…¥æ–‡ä»¶æƒé‡
    iflag  = 3 
    weight(1) = 1.0
    output_format = 5 !6 cube, 5xsf
    !fileout = 'chargedensity.cube' 
    fileout = 'chargedensity.xsf' 
/

</code></pre></div></div>
<p>é“åŸå­è¾ƒå¤§å¯èƒ½ä¼šè¦†ç›–ç”µè·çš„æ˜¾ç¤ºï¼ŒæŠŠåŸå­åŠå¾„è°ƒå°å°±çœ‹è§äº†<br />
<img src="/uploads/2020/03/chargedensity.png" alt="" /></p>

<p>è¿™æ¬¡vestaæ‰“å¼€chargedensity.xsfæ²¡æœ‰è‡ªåŠ¨æ˜¾ç¤ºç”µè·å¯†åº¦ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ•°å€¼å¤ªå°ï¼Œå¯ä»¥<strong>Utilities/2D Data Display</strong>æŸ¥çœ‹
æŠŠPPçš„<code class="highlighter-rouge">&amp;PLOT</code>è°ƒæ•´å¯ç»˜åˆ¶cubeæ ¼å¼ï¼Œvestaéƒ½æ”¯æŒxsfå’Œcubeæ ¼å¼</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    output_format = 6
    fileout = 'chargedensity.cube' 
</code></pre></div></div>

<h3 id="feç£æ€§ææ–™">Feç£æ€§ææ–™</h3>
<p><strong>Iron has two remarkable features: it is magnetic and it requires an Ultrasoft PP (USPP) since its localized 3d atomic states are very hard.</strong>
è‹¥ä¸ç”¨USPPï¼Œectoffè¦å–å¾ˆé«˜<br />
Feæ˜¯é‡‘å±ææ–™ï¼Œä¹Ÿè¦è®¾ç½®smearing<br />
å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-1/example5.Fe
</code></pre></div></div>
<h4 id="é“ç£fmåé“ç£afmè®¡ç®—">é“ç£FMï¼Œåé“ç£AFMè®¡ç®—</h4>
<ul>
  <li><strong>è®¡ç®—åé“ç£ï¼Œè¦æ„å»ºè¶…èƒï¼Œå¹¶æŒ‡å®šä¸åŒçš„åˆå§‹ç£çŸ©ï¼Œè¿˜è¦ä½¿ç”¨ä¸åŒçš„æ ‡ç­¾(Fe1,Fe2)</strong>,<br />
å› ä¸ºåˆå§‹ç£çŸ©å’Œntypå¯¹åº”ï¼Œ<code class="highlighter-rouge">starting_magnetization(1:ntyp)</code>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;SYSTEM

  ntyp = 2, !è®¾ç½®ä¸¤ç§ç±»å‹
  starting_magnetization(1) =  0.6
  starting_magnetization(2) = -0.6
 !...
/
ATOMIC_SPECIES
 Fe1  1.  Fe_ONCV_PBE_sr.upf
 Fe2  1.  Fe_ONCV_PBE_sr.upf
!...
</code></pre></div>    </div>
    <p>åˆ†åˆ«è¿è¡Œ</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.fe_fm.scf.in | tee fm.out
mpirun -np 4 pw.x -i pw.fe_afm.scf.in | tee afm.out
</code></pre></div>    </div>
    <p>æ£€æŸ¥ç£æ€§å’Œèƒ½é‡ï¼Œå¯ä»¥çœ‹åˆ°fmæ€»èƒ½é‡/åŸå­æ•°æ›´ä½</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cndaqiang@girl:example5.Fe$ grep magnetization fm.out | tail -2
   total magnetization       =      1.853765 Bohr mag/cell
   absolute magnetization    =      1.863940 Bohr mag/cell
cndaqiang@girl:example5.Fe$ grep ! fm.out 
!    total energy              =    -240.27909971 Ry
cndaqiang@girl:example5.Fe$ grep magnetization afm.out | tail -2
   total magnetization       =     -0.000295 Bohr mag/cell
   absolute magnetization    =      0.008622 Bohr mag/cell
cndaqiang@girl:example5.Fe$ grep ! afm.out 
!    total energy              =    -480.47700464 Ry
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="dos">DOS</h4>
<p><strong>nscfç®—DOSæ—¶ï¼Œå æ®æ–¹å¼ä¸º<code class="highlighter-rouge">occupations = 'tetrahedra'</code>ï¼Œä¸ç”¨è®¾ç½®<code class="highlighter-rouge">smearing</code>ç­‰å‚æ•°</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.fe_fm.scf.in | tee fm.out
mpirun -np 4 pw.x -i pw.fe_fm.nscf.in | tee fmnscf.out
dos.x -i dos.in 
./dos_nspin.py #ç”»å›¾
</code></pre></div></div>
<p>å¯ä»¥å¯¹æ¯”åŒæ ·çš„kç‚¹(12x12x12)ä½¿ç”¨scfå’Œnscfçš„ç»“æœåˆ†åˆ«ç”»çš„dosï¼Œnscfçš„ç»“æœæ›´å¹³æ»‘
<img src="/uploads/2020/03/fedos.png" alt="" /></p>

<h4 id="pdos-projwfcx">PDOS projwfc.x</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.fe_fm.scf.in | tee fm.out
mpirun -np 4 pw.x -i pw.fe_fm.nscf.in | tee fmnscf.out
projwfc.x -i pdos.in 
./pdos_nspin.py  #ç”»å›¾
</code></pre></div></div>
<p>ç”Ÿæˆç±»ä¼¼<code class="highlighter-rouge">fe.pdos.pdos_atm#1(Fe)_wfc#1(s)</code>æ–‡ä»¶åçš„æ•°æ®æ–‡ä»¶<br />
æ–‡ä»¶ç»“æ„(nspin=2æ—¶åŠ å€):</p>
<ul>
  <li>s<br />
ldos(S) pdos(S)</li>
  <li>p<br />
ldos(p) pdos: px py pz</li>
  <li>d<br />
ldos(d) pdos:dz2	dxz	dyz	dxy	dx2-y2</li>
</ul>

<p><strong>LDOS: s, p, d, fè½¨é“çš„æ€å¯†åº¦</strong><br />
<strong>PDOS: s, p, d, fè½¨é“çš„æŠ•å½±æ€å¯†åº¦</strong><br />
projwfc.xçš„è¾“å…¥æ–‡ä»¶å’Œdos.xè¾“å…¥ç±»ä¼¼</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;PROJWFC
    filpdos = 'fe.pdos' !pdosæ˜¯filpdosï¼Œdosæ˜¯fildos
    Emin = 8.0
    Emax = 25.0,
    DeltaE = 0.1
/

</code></pre></div></div>
<p><img src="/uploads/2020/03/fepdos.png" alt="" /></p>

<h3 id="feo-dftu">FeO DFT+U</h3>
<p><strong>QEä»…æ”¯æŒç‰¹å®šå…ƒç´ +U</strong>
<br />ä»<code class="highlighter-rouge">/Modules/set_hubbard_n.f90</code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ”¯æŒçš„å…ƒç´ å’ŒåŠ Uè½¨é“çš„ä¸»é‡å­æ•°n
<br />ä»<code class="highlighter-rouge">/Modules/set_hubbard_l.f90</code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ”¯æŒçš„å…ƒç´ å’ŒåŠ Uè½¨é“çš„è½¨é“é‡å­æ•°l
<br />å¯¹äºFe,n=3,l=2,å³3dè½¨é“åŠ U
<br />å¦‚æœæ‰€è¦åŠ Uçš„å…ƒç´ ä¸å†QEæ”¯æŒèŒƒå›´å†…ï¼Œå¯ä»¥æ”¹ä»£ç æ”¯æŒ</p>
<blockquote>
  <p>DFT+U (formerly known as LDA+U) currently works only for a few selected elements. Modify Modules/set_hubbard_l.f90 and PW/src/tabd.f90 if you plan to use DFT+U with an element that is not configured there.</p>
</blockquote>

<p>èµåŠ¿çš„é€‰å–å¾ˆå½±å“ç»“æœ,å¦‚å·¦è¾¹<code class="highlighter-rouge">Fe_ONCV_PBE_fr.upf</code>ç®—å¾—FeOä¸ºå¯¼ä½“,å³è¾¹<code class="highlighter-rouge">Fe.pbesol-spn-kjpaw_psl.0.2.1.UPF</code>ç®—çš„FeOä¸ºåŠå¯¼ä½“<br />
<img src="/uploads/2020/03/psedo.png" alt="" />
è€Œä½¿ç”¨<code class="highlighter-rouge">Fe.pbesol-spn-kjpaw_psl.1.0.0.UPF</code>ï¼Œç›´æ¥æŠ¥é”™<br /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     axis vectors are left-handed
               file Fe.pbesol-spn-kjpaw_psl.1.0.0.UPF: wavefunction(s)  3P 3D renormalized
               file Fe.pbesol-spn-kjpaw_psl.1.0.0.UPF: wavefunction(s)  3P 3D renormalized
           3          10

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     Error in routine set_dft_from_name (1):
      conflicting values for igcx
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

     stopping ...
</code></pre></div></div>
<p>å› æ­¤ä¹‹åçš„è®¡ç®—é‡‡ç”¨æ¨èçš„èµåŠ¿</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fe1  55.845  Fe.pbesol-spn-kjpaw_psl.0.2.1.UPF
Fe2  55.845  Fe.pbesol-spn-kjpaw_psl.0.2.1.UPF
O     16.0   O.pbesol-n-kjpaw_psl.0.1.UPF
</code></pre></div></div>
<p>å·¥ä½œè·¯å¾„</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LearnQE/DOC/material-for-ljubljana-qe-summer-school-master/Day-2/example4.functionals/ex1.DFT+U
</code></pre></div></div>

<h4 id="ä¸åŠ u">ä¸åŠ U</h4>
<p>è™½ç„¶FeOå®éªŒæ˜¯åŠå¯¼ä½“ï¼Œä½†æ˜¯è®¡ç®—æ˜¯å¯¼ä½“ï¼Œæ‰€ä»¥SCFè®¡ç®—è¦è®¾ç½®smearing<br />
åé“ç£ææ–™ï¼Œæ‰€ä»¥å»ºè¶…èƒï¼ŒFeæ ‡ç­¾ä¸åŒï¼Œç”¨äºæŒ‡å®šä¸åŒçš„åˆå§‹ç£çŸ©</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.FeO.scf.in | tee scf.out
mpirun -np 4 pw.x -i pw.FeO.nscf.in | tee nscf.out
projwfc.x -i projwfc.FeO.in
./pdos_nspin.py
</code></pre></div></div>
<h4 id="åŠ u">åŠ U</h4>
<p>æ·»åŠ Uå€¼åœ¨scfå’Œnscfçš„è®¡ç®—ä¸­ï¼Œå‚æ•°ç›¸åŒ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    lda_plus_u = .true.,
    !+Uçš„ç±»å‹
    lda_plus_u_kind = 0, 
    !   0   simplified version of Cococcioni and de Gironcoli,
    !   PRB 71, 035105 (2005), using Hubbard_U
    !   1   rotationally invariant scheme of Liechtenstein et al.,
    !   using Hubbard_U and Hubbard_J

    !U_projection_typeè½¨é“çš„é€‰æ‹©æ–¹å¼
    U_projection_type = 'atomic',
    !Hubbard_U(i), i=1,ntyp ä»…å¯¹éœ€è¦çš„å…ƒç´ +Uå€¼ï¼Œ 
    !Uå€¼å¯æ ¹æ®Timrov, N. Marzari, M. Cococcioni, PRB 98, 085127 (2018)è®¡ç®—
    Hubbard_U(1) = 5.2
    Hubbard_U(2) = 5.2
</code></pre></div></div>
<p>æ‰§è¡Œ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.FeO.scfU.in | tee scfU.out
mpirun -np 4 pw.x -i pw.FeO.nscfU.in | tee nscfU.out
projwfc.x -i projwfc.FeO.in
./pdos_nspin.py
</code></pre></div></div>
<p>åŠ Uåç®—å‡ºæ¥çš„ä»æ˜¯å¯¼ä½“ï¼Œæ ¹æ®<a href="http://qe2019.ijs.si/">Summer School on Advanced Materials and Molecular Modelling</a>ï¼Œä¼˜åŒ–åˆ°äº†å±€åŸŸæœ€å°å€¼<br />
é€šè¿‡è®¾ç½®<code class="highlighter-rouge">starting_ns_eigenvalue(m,ispin,ityp)</code>ï¼Œè®¡ç®—å‡ºå…¨å±€æœ€å°å€¼</p>

<h4 id="åŠ u--starting_ns_eigenvaluemispinityp">åŠ U &amp; starting_ns_eigenvalue(m,ispin,ityp)</h4>
<p>åœ¨scfæ—¶æ·»åŠ ï¼Œå°½åœ¨ç¬¬ä¸€ä¸ªscfåˆå§‹è¿­ä»£æ—¶ç”Ÿæ•ˆ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    starting_ns_eigenvalue(5,2,1) = 1.0
    starting_ns_eigenvalue(5,1,2) = 1.0
</code></pre></div></div>
<p>é€‰æ‹©5,2,1ä¸5,1,2çš„åŸå› æ˜¯,æ ¹æ®scf+Uçš„å±å¹•è¾“å‡ºï¼Œåœ¨ç¬¬ä¸€ä¸ªscfå†…ï¼Œatom1çš„spin2çš„ç¬¬5ä¸ªæœ¬å¾å€¼(0.296)æ˜¯éç®€å¹¶çš„(å‰é¢å››ä¸ªéƒ½æ˜¯2é‡ç®€å¹¶)<br />
atom2åŒç†</p>
<blockquote>
  <p>Why 5-th state? Because it is the one which is non-degenerate and if occupied fully could lead to an insulating result.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     iteration #  1     ecut=    30.00 Ry     beta= 0.30
......
atom    1   Tr[ns(na)] (up, down, total) =   5.00636  1.09500  6.10136
   spin  1
    eigenvalues: 
  1.000  1.000  1.002  1.002  1.002
......
   spin  2
    eigenvalues: 
  0.129  0.129  0.270  0.270  0.296
......
</code></pre></div></div>

<p>åœ¨è¾“å‡ºä¼šæœ‰è¿™æ ·çš„è¯­å¥æç¤º<code class="highlighter-rouge"> Modify starting ns matrices according to input values </code>ï¼Œç„¶åä¿®æ”¹values
å…¶ä½™ä¸å˜</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun -np 4 pw.x -i pw.FeO.scfUns.in | tee scfUns.out
mpirun -np 4 pw.x -i pw.FeO.nscfU.in | tee nscfU.out
projwfc.x -i projwfc.FeO.in
./pdos_nspin.py
</code></pre></div></div>

<p>ä¸‰ç§æƒ…å†µçš„DOSï¼Œ+Uä¸starting_ns_eigenvalueå¯ä»¥ç®—å¾—åŠå¯¼ä½“çš„æƒ…å†µ
<img src="/uploads/2020/03/udos.png" alt="" /></p>

<p>é€šè¿‡æ¯”è¾ƒèƒ½é‡ï¼Œè°ƒæ•´ä¹‹åèƒ½é‡æ˜¯æ›´ä½äº†ä¸€äº›
-735.172(+U &amp; starting_ns_eigenvalue ) &lt; -734.99424361(+U)</p>

:ET