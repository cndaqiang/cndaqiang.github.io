---
layout: post
title:  "oneplus6åˆ·windows 11 armç­‰"
date:   2021-07-09 11:34:00 +0800
categories: Linux
tags:  Linux oneplus arm 
author: cndaqiang
mathjax: true
---
* content
{:toc}

oneplus6åˆ·æœºè¿‡ç¨‹ä¸­è¿˜é‡åˆ°äº†å…¶ä»–çš„é—®é¢˜, è®°å½•ä¸€ä¸‹





## å‚è€ƒ

ä¸»è¦å‚è€ƒäº†oneplus6tçš„æ•™ç¨‹
- [Windows10 on arm64@Skr-niao'Blog](https://silime.gitee.io/2021/05/20/Windows10-on-arm64/)
- [ç»™æ‰‹æœºè£…Windows11ï¼è¿˜èƒ½ç©å¤§å‹æ¸¸æˆï¼Ÿï¼@æå®¢æ¹¾Geekerwan](https://www.bilibili.com/video/BV1MU4y137Yi)
- [How to downgrade OnePlus 6/6T to Android 9 Pie from Android 10](https://nerdschalk.com/how-to-roll-back-oneplus-6-6t-to-android-9-pie/)
- [TWRP: Could not mount /data (even after format data / change file system)](https://www.titanwolf.org/Network/q/1bc1323e-e07d-4dd7-a892-6423236d6649/x)



## èµ„æºä¸‹è½½
æœ¬æ–‡ç”¨åˆ°çš„æ–‡ä»¶ä¸»è¦æ¥è‡ªå‚è€ƒæ•™ç¨‹:
- [ä¸€åŠ 6åˆ·æœºæ–‡ä»¶ä¸‹è½½, å¯†ç : enkh](https://pan.baidu.com/s/1z67ETDYb-avwVP6OUIRUCw)<br>
ä¸åŒ…å«windowsé•œåƒ,å¯ä»¥ä½¿ç”¨aria2ä»[UUP dump](https://uupdump.net/?lang=zh-cn)ä¸‹è½½å¾ˆå¿«


æ³¨:
- ä¸€åŠ 6çš„ä»£å·æ˜¯enchilada,ä¸‹è½½ç›¸å…³æ–‡ä»¶æ³¨æ„è¯¥å…³é”®è¯
- å¯ä»¥å…³æ³¨æœ€æ–°SDM845é©±åŠ¨[GitHub -WOA-Drivers](https://github.com/edk2-porting/WOA-Drivers)æ›´æ–°æƒ…å†µ,ç”¨æœ€æ–°çš„é©±åŠ¨
- å¯å…³æ³¨æœ€æ–°çš„efi:  [boot-enchilada.img](https://github.com/edk2-porting/edk2-sdm845/releases),ä»¥åŠå¤§ä½¬ä»¬æä¾›uefi
- PEä»¥åŠwindows10/11ç”¨ARMç‰ˆçš„éƒ½å¯ä»¥


## è§£BLé”
**è§£é”ä¼šä¸¢å¤±æ‰€æœ‰ç”¨æˆ·æ•°æ®**
- è¿›å…¥å¼€å‘è€…æ¨¡å¼: å…³äºæ‰‹æœº>è¿ç‚¹äº”æ¬¡ç‰ˆæœ¬å·
- ç³»ç»Ÿ>å¼€å‘è€…é€‰é¡¹>OEMè§£é”,USBè°ƒè¯•,ä¸€å¾‹å…è®¸USBè°ƒè¯•

- è§£é”: è¿™é‡Œä½¿ç”¨`ä¸€åŠ å…¨æœºå‹ä¸‡èƒ½å·¥å…·ç®±v3.8.1.exe`,å…¶ä»–æ–¹å¼ä¹Ÿå¯ä»¥
![](/uploads/2021/07/oneplustool.png)
éŸ³é‡é€‰æ‹©unlock,ç”µæºé”®ç¡®è®¤
![](/uploads/2021/07/unlock.png)
- è§£é”å,å› ä¸ºä¸¢å¤±æ•°æ®,ç¬¬ä¸€æ¬¡å¼€æœºæ¯”è¾ƒæ…¢

## åˆ·twrp
è¿™é‡Œä½¿ç”¨`ä¸€åŠ å…¨æœºå‹ä¸‡èƒ½å·¥å…·ç®±v3.8.1.exe`

### å®‰å“10é™çº§å®‰å“9
å› ä¸º`ä¸€åŠ å…¨æœºå‹ä¸‡èƒ½å·¥å…·ç®±v3.8.1.exe`ç›®å‰åªèƒ½ç»™å®‰å“9ä»¥ä¸‹çš„ä¸€åŠ 6åˆ·twrp,æ‰€ä»¥è¦é™çº§.<br>
å¦‚æœèƒ½é€šè¿‡å…¶ä»–æ–¹å¼åˆ·å…¥twrpåˆ™ä¸éœ€è¦é™çº§.

#### å¡åˆ·
å¤åˆ¶`fulldowngrade_wipe_MSM_17819_181025_2315_user_MP1_release.zip`åˆ°æ‰‹æœº<br>
ç³»ç»Ÿ>ç³»ç»Ÿæ›´æ–°>é½¿è½®>æœ¬åœ°å‡çº§<br>
(æ³¨: `fulldowngrade_wipe_MSM_17819_181025_2315_user_MP1_release.zip`è¿™ä¸ªå¡åˆ·åŒ…æ˜¯å›½å¤–çš„,å¼€æœºæ–­å¼€ç½‘ç»œå’Œæ‰‹æœºå¡,ä¸ç„¶ä¸€ç›´è¿ä¸ä¸ŠgoogleéªŒè¯)

#### çº¿åˆ·
ä¹Ÿå¯ä»¥ç”¨MsmDownloadToolçº¿åˆ·å®‰å“9çš„åŒ…. æ–¹æ³•è§ä¸‹.<br>
é“¾æ¥ä¸­æä¾›äº†å®‰å“8çš„H2_5.1.3ç³»ç»Ÿ

#### åˆ·æœºåæ‰“å¼€usbè°ƒè¯•

### åˆ·twrp
ä¸€åŠ 6è¦åˆ·ä¸¤æ¬¡, æŒ‰ç…§æç¤ºæ“ä½œå³å¯
- Advanced > ADB Sideload
- å›è½¦ç¬¬ä¸€éåˆ·å®Œ
- Back
- Advance > ADB Sideload
- å›è½¦å†åˆ·ä¸€é

## åˆ†åŒº
è¿›å…¥twrpç•Œé¢
### æ–¹æ³•ä¸€: ç”µè„‘adbè°ƒè¯•
- è¿ä¸Šç”µè„‘å¤åˆ¶partedåˆ°æ‰‹æœºå¹¶åˆ†åŒº
![](/uploads/2021/07/parted.png)

```bash
C:\Users\cndaqiang>adb shell
#
cp /sdcard/parted /sbin
chmod +x /sbin/parted
```

![](/uploads/2021/07/adbshell.png)

- å¸è½½dataåˆ†åŒº
```
umount /data && umount /sdccard
#æˆ–è€…æ ¹æ®df -h ç¡®å®šdataæ˜¯sdaçš„ç¬¬17ä¸ªåˆ†åŒº
umount /dev/block/sda17
```

- è¿›å…¥åˆ†åŒºç•Œé¢
```
parted /dev/block/sda
```
![](/uploads/2021/07/sdap.png)
```
rm 17 
#ä¸‹é¢çš„èµ·å§‹ç»“æŸä½ç½®ä¸åŒç±»å‹çš„æ‰‹æœºä¸åŒ,æ ¹æ®pè¿”å›çš„ä¿¡æ¯ä¿®æ”¹
mkpart esp fat32 6559MB 7000MB
mkpart pe fat32 7000MB 10000MB
mkpart win ntfs 10000MB 70GB
mkpart userdata ext4 70GB 125GB
set 17 esp on
#æŒ‰qé€€å‡º
q
```
æœ€ç»ˆåˆ†åŒºçš„ç»“æœ
![](/uploads/2021/07/sdap2.png)

- æ ¼å¼åŒ–æ–°åˆ†åŒº<br>
å‚è€ƒæ•™ç¨‹ä¸­ç»™å‡ºoneplus6tæ˜¯é€šè¿‡`/dev/block/by-name/pe`çš„æ–¹å¼åˆ†çš„, æˆ‘æ‰‹é‡Œçš„ç‰ˆæœ¬,ä¸å­˜åœ¨è¯¥æ–‡ä»¶å¤¹`/dev/block/by-name`<br>
ä¸‹é¢é€šè¿‡ç¡¬ç›˜ç¼–å·åˆ†åŒº,æ ¹æ®ä¸Šé¢åˆ†çš„ç»“æœ`esp,pe,win,userdata`åˆ†åˆ«æ˜¯`17,18,19,20`
```
mkfs.fat -F32 -s1 /dev/block/sda17
mkfs.fat -F32 -s1 /dev/block/sda18
mkfs.ntfs -f /dev/block/sda19
mke2fs -t ext4 /dev/block/sda20
```
å†ç»™`userdata`åˆ†åŒºæ—¶å‡ºç°é”™è¯¯,ä¸å½±å“,å¯ä»¥ä¹‹åè¿›fastbootåˆ†åŒº
```
~ # [6nmke2fs -t ext4 /dev/block/sda20
mke2fs -t ext4 /dev/block/sda20
CANNOT LINK EXECUTABLE "mke2fs": library "libext2_misc.so" not found
libc: CANNOT LINK EXECUTABLE "mke2fs": library "libext2_misc.so" not found
libc: Fatal signal 6 (SIGABRT), code -6 in tid 938 (mke2fs), pid 938 (mke2fs)
Aborted
```


### æ–¹æ³•äºŒ: twrpç•Œé¢æ“ä½œæ–¹æ³•
- æŠŠpartedæ”¾åˆ°Uç›˜(å¾ˆå›¾å½¢åŒ–çš„æ“ä½œ)
- æ’å…¥Uç›˜
- - twrp>Mount>USB Storage
- - twrp>Advanced>File Manager<br>
è¿›å…¥`/usbstroage/` ,æŒ‰ä½`parted`æ–‡ä»¶,<br>
å¤åˆ¶åˆ°`/sbin`(å…¶å®å¤åˆ¶åˆ°å“ªéƒ½æ— æ‰€è°“,åé¢æ‰§è¡Œæ—¶æŒ‡å®špartedçš„ç»å¯¹è·¯å¾„å³å¯)<br>
è¿›å…¥`/sbin/`,`parted` å¯æ‰§æƒé™`chmod 775`

- twrp>Adcance>Terminal<br>
è¾“å…¥åŒæ–¹æ³•ä¸€çš„å‘½ä»¤,å¸è½½å’Œåˆ†åŒº


## å¤åˆ¶PEåˆ°peåˆ†åŒº
```
mount /dev/block/sda18 /mnt
```
æ’å…¥åŒ…å«PEæ–‡ä»¶çš„Uç›˜åˆ°æ‰‹æœº<br>
twrp>Adcance>Terminal,å¤åˆ¶PEåˆ°æŒ‚è½½ç‚¹`/mnt`
```
cp /usbstroage/20h2pe_new/* /mnt
```
![](/uploads/2021/07/cppe.png)

## UEFIå¼•å¯¼å¼€æœº
é‡å¯è¿›å…¥Bootload<br>
å…ˆä¿®å¤åˆšæ‰dataåˆ†åŒºæ ¼å¼åŒ–å‡ºé”™,CMDè¾“å…¥
```
fastboot format:ext4 userdata
```
ä»uefiçš„bootå¯åŠ¨
```
fastboot boot D:\cndaqiang\Download\boot-enchilada.img
```
ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªimgç›´æ¥åˆ·å…¥çš„booté‡Œé¢(æ²¡å¿…è¦),ä¸åˆ·åˆ™æ¯æ¬¡å¼€æœºè¿›windowséƒ½è¦è¿›fastbootå¯åŠ¨<br>
flashå‘½ä»¤(**æ…ç”¨**)
```
fastboot flash boot D:\cndaqiang\Download\boot-enchilada.img
```

## å®‰è£…ç³»ç»Ÿ
### è¿›å…¥PEç•Œé¢
fastbootå‘½ä»¤ç†Ÿå®Œåå°±ä¼šè¿›è¡ŒARMç‰ˆçš„PEç•Œé¢
### è£…è½½ISOæ–‡ä»¶
æå‰è§£å‹ä¹Ÿ,æˆ‘ä»¬è¦ç”¨åˆ°é‡Œé¢`/source/install.wim`æ–‡ä»¶
![](/uploads/2021/07/armpe.png)

### æ‰“å¼€ARMç‰ˆçš„DISM++
å’Œåœ¨PEä¸‹ç»™x86è£…ç³»ç»Ÿæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«
- é‡Šæ”¾é•œåƒ
æ–‡ä»¶>é‡Šæ”¾é•œåƒ,é€‰æ‹©`install.wim`å’Œè¦å®‰è£…åˆ°çš„åˆ†åŒºï¼Œ**æ³¨æ„é’©ä¸Šæ·»åŠ å¼•å¯¼**
![](/uploads/2021/07/dism.png)
- åŠ è½½é©±åŠ¨
æ‰“å¼€å¯¹è¯>é©±åŠ¨ç®¡ç†>æ‰“å¼€WOAçš„é©±åŠ¨
![](/uploads/2021/07/woa.png)

- å…³é—­é©±åŠ¨éªŒè¯
PEä¸­çš„CMD
```
#è¿™ä¸ªæŒ‚è½½EFIåˆ†åŒºçš„å‘½ä»¤åœ¨å…¶ä»–æ•™ç¨‹ä¸­ä¹Ÿæ²¡æåˆ°
mountvol Y: /S
bcdedit /store Y:\efi\microsoft\boot\bcd /set {Default} testsigning on
bcdedit /store Y:\efi\microsoft\boot\bcd /set {Default} nointegritychecks on
```

## å¼€æœº
ä»uefiçš„bootå¯åŠ¨
```
fastboot boot D:\cndaqiang\Download\boot-enchilada.img
```
è·Ÿæå®¢æ¹¾Geekerwançš„è§†é¢‘æ•™ç¨‹ä¸€è‡´ï¼Œç¬¬ä¸€æ¬¡è“å±, å…³æœºåå†`fastboot`å¯åŠ¨ä¸€æ¬¡å°±å¯ä»¥äº†<br>
![](/uploads/2021/07/ra2.png)

å¾ˆå¤šç¡¬ä»¶è¿˜æ˜¯æ²¡æœ‰é€‚é…,è§¦å±è™½ç„¶èƒ½ç”¨ä¹Ÿç‚¹ä¸å‡†



## åˆ·Ubuntu Touch
å‚è€ƒ[ubports-oneplus6](https://github.com/ubports-oneplus6/documentation)<br>
å¯ä»¥å»ä¸Šé¢ä»“åº“çœ‹çœ‹æœ‰æ²¡æœ‰æœ€æ–°ç‰ˆ<br>
ç›®å‰çš„bug:
- ç”µä¿¡å¡ä¸è¯†åˆ«
- è”é€šå¡åªèƒ½ç”¨å¡2æ§½

è¿‡ç¨‹:
- ä¸‹è½½Releaseä¸­çš„`target.zip`å’Œ`halium-boot.img`
- å¤åˆ¶`target.zip`åˆ°æ‰‹æœºå­˜å‚¨
- twrpå®‰è£…`target.zip`
- å¯åŠ¨,**é»˜è®¤å¯†ç æ˜¯`phablet`**
```
fastboot boot D:\cndaqiang\Download\halium-boot.img
```
ä¹Ÿå¯ä»¥å†™å…¥
```
fastboot flash boot D:\cndaqiang\Download\halium-boot.img
```

![](/uploads/2021/07/utouch.png)

UbuntuTouch/Win11/Oneplusç³»ç»Ÿå¯ä»¥å¹¶å­˜,è®¾ç½®fastbootå¯åŠ¨ä¸åŒimgå³å¯

##  å…¶ä»–å¤‡ç”¨
### ä¸€åŠ çº¿åˆ·æ¢å¤: MsmDownloadTool 
ä¸€é”®å›åŸå‚, æ¢å¤ä¸€åŠ é»˜è®¤Recover,ç³»ç»Ÿ,ç¡¬ç›˜åˆ†åŒº,åŠ BLé”ç­‰.
- æŒ‰ä½`ç”µæº`+`éŸ³é‡+`,è¿æ¥æ•°æ®çº¿,æ‰‹æœºåº”è¯¥å°±é»‘å±, è®¾å¤‡ç®¡ç†å™¨æŸ¥çœ‹åˆ°COMè®¾å¤‡åæ¾æ‰‹<br>
![](/uploads/2021/07/9008.png)
- windowsè‡ªåŠ¨æ›´æ–°9008é©±åŠ¨
- MsmDownloadTool:startè¿›è¡Œçº¿åˆ·æ¢å¤
![](/uploads/2021/07/msmdownloadtool.png)




------
>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ [CC BY-SA 4.0 åè®®](https://creativecommons.org/licenses/by-sa/4.0/deed.zh) ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
